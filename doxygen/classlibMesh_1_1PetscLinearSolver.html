<!-- HTML header for doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>libMesh: libMesh::PetscLinearSolver&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="../styles.css" rel="stylesheet" type="text/css" />
<link href="doxygen_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
  <nav id="fixedbar">
    <ul id="fixednav">
      <li><a href="../index.html">Home</a></li>
      <li><a href="../support.html">About Us</a></li>
      <li><a href="../publications.html">Publications</a></li>
      <li><a href="../developers.html">Developers</a></li>
      <li><a href="../installation.html">Installation</a></li>
      <li><a href="../examples.html">Examples</a></li>
      <li><a href="../doxygen/index.html">Documentation</a></li>
    </ul>
  </nav>
  <div id="w">
    <header id="logo"><a href="index.html"><span id="logobg">SomeWebsiteLogo</span></a></header>
    <nav id="navigation">
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../support.html">About Us</a></li>
        <li><a href="../publications.html">Publications</a></li>
        <li><a href="../developers.html">Developers</a></li>
        <li><a href="../installation.html">Installation</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../doxygen/index.html">Documentation</a></li>
      </ul>
    </nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <\!--BEGIN TITLEAREA-\-> -->
<!-- <div id="titlearea"> -->
<!-- <table cellspacing="0" cellpadding="0"> -->
<!--  <tbody> -->
<!--  <tr style="height: 56px;"> -->
<!--   <\!--BEGIN PROJECT_LOGO-\-> -->
<!--   <td id="projectlogo"><img alt="Logo" src=""/></td> -->
<!--   <\!--END PROJECT_LOGO-\-> -->
<!--   <\!--BEGIN PROJECT_NAME-\-> -->
<!--   <td style="padding-left: 0.5em;"> -->
<!--    <div id="projectname">libMesh -->
<!--    <\!--BEGIN PROJECT_NUMBER-\->&#160;<span id="projectnumber"></span><\!--END PROJECT_NUMBER-\-> -->
<!--    </div> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-><div id="projectbrief"></div><\!--END PROJECT_BRIEF-\-> -->
<!--   </td> -->
<!--   <\!--END PROJECT_NAME-\-> -->
<!--   <\!--BEGIN !PROJECT_NAME-\-> -->
<!--    <\!--BEGIN PROJECT_BRIEF-\-> -->
<!--     <td style="padding-left: 0.5em;"> -->
<!--     <div id="projectbrief"></div> -->
<!--     </td> -->
<!--    <\!--END PROJECT_BRIEF-\-> -->
<!--   <\!--END !PROJECT_NAME-\-> -->
<!--   <\!--BEGIN DISABLE_INDEX-\-> -->
<!--    <\!--BEGIN SEARCHENGINE-\-> -->
<!--    <td></td> -->
<!--    <\!--END SEARCHENGINE-\-> -->
<!--   <\!--END DISABLE_INDEX-\-> -->
<!--  </tr> -->
<!--  </tbody> -->
<!-- </table> -->
<!-- </div> -->
<!-- <\!--END TITLEAREA-\-> -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html">PetscLinearSolver</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classlibMesh_1_1PetscLinearSolver-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::PetscLinearSolver&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libMesh::PetscLinearSolver&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classlibMesh_1_1PetscLinearSolver__inherit__graph.png" border="0" usemap="#libMesh_1_1PetscLinearSolver_3_01T_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="libMesh_1_1PetscLinearSolver_3_01T_01_4_inherit__map" id="libMesh_1_1PetscLinearSolver_3_01T_01_4_inherit__map">
<area shape="rect" id="node2" href="classlibMesh_1_1LinearSolver.html" title="libMesh::LinearSolver\&lt; T \&gt;" alt="" coords="108,171,289,197"/><area shape="rect" id="node3" href="classlibMesh_1_1ReferenceCountedObject.html" title="libMesh::ReferenceCounted\lObject\&lt; LinearSolver\&lt; T \&gt; \&gt;" alt="" coords="5,81,195,122"/><area shape="rect" id="node4" href="classlibMesh_1_1ReferenceCounter.html" title="libMesh::ReferenceCounter" alt="" coords="8,5,192,32"/><area shape="rect" id="node5" href="classlibMesh_1_1ParallelObject.html" title="libMesh::ParallelObject" alt="" coords="219,88,377,115"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a47c322a43214968f8d1ea1ea8d1a27b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a47c322a43214968f8d1ea1ea8d1a27b1">PetscLinearSolver</a> (const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">libMesh::Parallel::Communicator</a> &amp;comm_in LIBMESH_CAN_DEFAULT_TO_COMMWORLD)</td></tr>
<tr class="separator:a47c322a43214968f8d1ea1ea8d1a27b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e98c6de5eb553ba0262291ac49a8743"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a1e98c6de5eb553ba0262291ac49a8743">~PetscLinearSolver</a> ()</td></tr>
<tr class="separator:a1e98c6de5eb553ba0262291ac49a8743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3284c33fc49f7f37f013f2be6826ca3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#ad3284c33fc49f7f37f013f2be6826ca3">clear</a> () libmesh_override</td></tr>
<tr class="separator:ad3284c33fc49f7f37f013f2be6826ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fa06334f777e9c90c96d69a052985e5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a> (const char *name=NULL) libmesh_override</td></tr>
<tr class="separator:a8fa06334f777e9c90c96d69a052985e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd759dad2438c6fb10cca1caecb3b68a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#abd759dad2438c6fb10cca1caecb3b68a">init</a> (<a class="el" href="classlibMesh_1_1PetscMatrix.html">PetscMatrix</a>&lt; T &gt; *matrix, const char *name=NULL)</td></tr>
<tr class="separator:abd759dad2438c6fb10cca1caecb3b68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868f444745f8433c086ca14c69de9a6b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a868f444745f8433c086ca14c69de9a6b">init_names</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;) libmesh_override</td></tr>
<tr class="separator:a868f444745f8433c086ca14c69de9a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9462170c47c7d424153cdb578e5a38db"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a9462170c47c7d424153cdb578e5a38db">restrict_solve_to</a> (const std::vector&lt; unsigned int &gt; *const dofs, const <a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1">SubsetSolveMode</a> subset_solve_mode=<a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>) libmesh_override</td></tr>
<tr class="separator:a9462170c47c7d424153cdb578e5a38db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad81a95a20d13d097e436674228f8ba3f"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#ad81a95a20d13d097e436674228f8ba3f">solve</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;matrix_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;solution_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;rhs_in, const double tol, const unsigned int m_its) libmesh_override</td></tr>
<tr class="separator:ad81a95a20d13d097e436674228f8ba3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e66cc138b52e80e93a75e55315245ee"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a4e66cc138b52e80e93a75e55315245ee">adjoint_solve</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;matrix_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;solution_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;rhs_in, const double tol, const unsigned int m_its) libmesh_override</td></tr>
<tr class="separator:a4e66cc138b52e80e93a75e55315245ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c88eb33c8d78c15cf9ed4c1bf372336"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a5c88eb33c8d78c15cf9ed4c1bf372336">solve</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;preconditioner, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;solution, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;rhs, const double tol, const unsigned int m_its) libmesh_override</td></tr>
<tr class="separator:a5c88eb33c8d78c15cf9ed4c1bf372336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5670c09fd65a3edc711653734add41bd"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a5670c09fd65a3edc711653734add41bd">solve</a> (const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;shell_matrix, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;solution_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;rhs_in, const double tol, const unsigned int m_its) libmesh_override</td></tr>
<tr class="separator:a5670c09fd65a3edc711653734add41bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d0fbec932c6e0df11af0f85c7eaa212"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a9d0fbec932c6e0df11af0f85c7eaa212">solve</a> (const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;shell_matrix, const <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;precond_matrix, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;solution_in, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;rhs_in, const double tol, const unsigned int m_its) libmesh_override</td></tr>
<tr class="separator:a9d0fbec932c6e0df11af0f85c7eaa212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aae14fe9e4e8e350918d1f954fd0444"><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a1aae14fe9e4e8e350918d1f954fd0444">pc</a> ()</td></tr>
<tr class="separator:a1aae14fe9e4e8e350918d1f954fd0444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f722acb8c35301ed1581726d4024d60"><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a8f722acb8c35301ed1581726d4024d60">ksp</a> ()</td></tr>
<tr class="separator:a8f722acb8c35301ed1581726d4024d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8c73be13b0e349132fbd2f1a7e0efc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a1d8c73be13b0e349132fbd2f1a7e0efc">get_residual_history</a> (std::vector&lt; double &gt; &amp;hist)</td></tr>
<tr class="separator:a1d8c73be13b0e349132fbd2f1a7e0efc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37641e5e49a89c36098322f1e5b1f0d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a37641e5e49a89c36098322f1e5b1f0d8">get_initial_residual</a> ()</td></tr>
<tr class="separator:a37641e5e49a89c36098322f1e5b1f0d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2a93e69d2fc6ca23aac0500d356e6ba"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38db">LinearConvergenceReason</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#aa2a93e69d2fc6ca23aac0500d356e6ba">get_converged_reason</a> () const libmesh_override</td></tr>
<tr class="separator:aa2a93e69d2fc6ca23aac0500d356e6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d7de69910e031898f5786b61816f72"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">initialized</a> () const </td></tr>
<tr class="separator:ac9d7de69910e031898f5786b61816f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56acf56ca513a30cea0a71c4391cda3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a56acf56ca513a30cea0a71c4391cda3a">solver_type</a> () const </td></tr>
<tr class="separator:a56acf56ca513a30cea0a71c4391cda3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a012e2e7a62aaaaaaa15ec0fdef891"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#ae2a012e2e7a62aaaaaaa15ec0fdef891">set_solver_type</a> (const <a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a> st)</td></tr>
<tr class="separator:ae2a012e2e7a62aaaaaaa15ec0fdef891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32740239cc7991d77b4166331514f2ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a32740239cc7991d77b4166331514f2ad">preconditioner_type</a> () const </td></tr>
<tr class="separator:a32740239cc7991d77b4166331514f2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bacfd14b9ad9cc5a996125dace2a021"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a9bacfd14b9ad9cc5a996125dace2a021">set_preconditioner_type</a> (const <a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a> pct)</td></tr>
<tr class="separator:a9bacfd14b9ad9cc5a996125dace2a021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae800697a18767330e32c14cc1c06aa91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#ae800697a18767330e32c14cc1c06aa91">attach_preconditioner</a> (<a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a>&lt; T &gt; *preconditioner)</td></tr>
<tr class="separator:ae800697a18767330e32c14cc1c06aa91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9afecdb20ca3b66e7a33b72ddcddee8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#ac9afecdb20ca3b66e7a33b72ddcddee8">reuse_preconditioner</a> (bool)</td></tr>
<tr class="separator:ac9afecdb20ca3b66e7a33b72ddcddee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a397b977d2247de8e923032a56d0c4b36"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a397b977d2247de8e923032a56d0c4b36">get_same_preconditioner</a> ()</td></tr>
<tr class="separator:a397b977d2247de8e923032a56d0c4b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3da3257c681022416a6f20b94c60eed"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#af3da3257c681022416a6f20b94c60eed">solve</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; *precond_matrix, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;, const double, const unsigned int)</td></tr>
<tr class="separator:af3da3257c681022416a6f20b94c60eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0164941ecaaf3e877fcb5fa89750f6"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#acc0164941ecaaf3e877fcb5fa89750f6">solve</a> (const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;matrix, const <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; *precond_matrix, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;, const double, const unsigned int)</td></tr>
<tr class="separator:acc0164941ecaaf3e877fcb5fa89750f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ad8a8998d0ccccf087c02a6d8292a0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a79ad8a8998d0ccccf087c02a6d8292a0">print_converged_reason</a> () const </td></tr>
<tr class="separator:a79ad8a8998d0ccccf087c02a6d8292a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3e64b8e6d70f7f32e8f427d9bfe38a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#ac3e64b8e6d70f7f32e8f427d9bfe38a5">set_solver_configuration</a> (<a class="el" href="classlibMesh_1_1SolverConfiguration.html">SolverConfiguration</a> &amp;solver_configuration)</td></tr>
<tr class="separator:ac3e64b8e6d70f7f32e8f427d9bfe38a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20de1180df21bdc9e6ca6151ed4ffda9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a> () const </td></tr>
<tr class="separator:a20de1180df21bdc9e6ca6151ed4ffda9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50719f74165b613ab929afd29b6d5f4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a50719f74165b613ab929afd29b6d5f4a">n_processors</a> () const </td></tr>
<tr class="separator:a50719f74165b613ab929afd29b6d5f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e7d1a1118f63d9889a761c27433bbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#ae1e7d1a1118f63d9889a761c27433bbc">processor_id</a> () const </td></tr>
<tr class="separator:ae1e7d1a1118f63d9889a761c27433bbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a3dd8a3d8d7c1e04b3b7ace0e1378b33f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacelibMesh.html#af0a78fa0f592d2b8f515c69cabfaf529">UniquePtr</a>&lt; <a class="el" href="classlibMesh_1_1LinearSolver.html">LinearSolver</a>&lt; T &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a3dd8a3d8d7c1e04b3b7ace0e1378b33f">build</a> (const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">libMesh::Parallel::Communicator</a> &amp;comm_in, const <a class="el" href="namespacelibMesh.html#a17745da36305535897ef6f57df9f6e01">SolverPackage</a> solver_package=<a class="el" href="namespacelibMesh.html#a496c62248223cd940c7715932dd0dc2d">libMesh::default_solver_package</a>())</td></tr>
<tr class="separator:a3dd8a3d8d7c1e04b3b7ace0e1378b33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103b37125ae9eaaadf6f7854df17faa2"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">get_info</a> ()</td></tr>
<tr class="separator:a103b37125ae9eaaadf6f7854df17faa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f46edb253f11a90bfc5f824b45ed596"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a6f46edb253f11a90bfc5f824b45ed596">print_info</a> (std::ostream &amp;<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">out</a>=<a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a>)</td></tr>
<tr class="separator:a6f46edb253f11a90bfc5f824b45ed596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a50e74641afc6e2870c9e1ce412f8c44f">n_objects</a> ()</td></tr>
<tr class="separator:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86837c50216b2ddb800b3836d2a08c09"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a86837c50216b2ddb800b3836d2a08c09">enable_print_counter_info</a> ()</td></tr>
<tr class="separator:a86837c50216b2ddb800b3836d2a08c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a5c0a2d3d3c531f9f069b0d623d4ace0f">disable_print_counter_info</a> ()</td></tr>
<tr class="separator:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::string, std::pair&lt; unsigned int, unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a></td></tr>
<tr class="separator:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a4d69475c6ae8e441306e90e57d755ced"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a4d69475c6ae8e441306e90e57d755ced">increment_constructor_count</a> (const std::string &amp;name)</td></tr>
<tr class="separator:a4d69475c6ae8e441306e90e57d755ced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8ca3935940b9b1a60f7645e856f2e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a9f8ca3935940b9b1a60f7645e856f2e4">increment_destructor_count</a> (const std::string &amp;name)</td></tr>
<tr class="separator:a9f8ca3935940b9b1a60f7645e856f2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a6b64a30f2023ff38c662536f79a4451a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a></td></tr>
<tr class="separator:a6b64a30f2023ff38c662536f79a4451a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866f963e86c384dc28fb3dbec70c5b39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a></td></tr>
<tr class="separator:a866f963e86c384dc28fb3dbec70c5b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97da17452484aa8121282f15248b8b9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a></td></tr>
<tr class="separator:a97da17452484aa8121282f15248b8b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1764c79388b56d08361c785aa265add0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a>&lt; T &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a></td></tr>
<tr class="separator:a1764c79388b56d08361c785aa265add0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851fb44823b601cd8502fd7688266c29"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a></td></tr>
<tr class="separator:a851fb44823b601cd8502fd7688266c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d4f205b150f8ca380e3338af168237"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SolverConfiguration.html">SolverConfiguration</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a></td></tr>
<tr class="separator:aa8d4f205b150f8ca380e3338af168237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a></td></tr>
<tr class="separator:a1ffb5b08919ab435109a302f94a7b3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a7c913252d05560f8bc7c75a63547c4c3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a></td></tr>
<tr class="separator:a7c913252d05560f8bc7c75a63547c4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1Threads_1_1atomic.html">Threads::atomic</a>&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a></td></tr>
<tr class="separator:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedbd3a4ce19686187449a8a0557b74b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1Threads_1_1spin__mutex.html">Threads::spin_mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#abedbd3a4ce19686187449a8a0557b74b">_mutex</a></td></tr>
<tr class="separator:abedbd3a4ce19686187449a8a0557b74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = true</td></tr>
<tr class="separator:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7ba2130af69add0da3a7526c79095090"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">set_petsc_solver_type</a> ()</td></tr>
<tr class="separator:a7ba2130af69add0da3a7526c79095090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005e7b0e81dbc5d604296fa441692d30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a7ad10af8599548704f3938639a33b5ca">PetscInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">_restrict_solve_to_is_local_size</a> (void) const </td></tr>
<tr class="separator:a005e7b0e81dbc5d604296fa441692d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53c040d15138a248ff0f1006aa42a23c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is</a> (const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;vec_in)</td></tr>
<tr class="separator:a53c040d15138a248ff0f1006aa42a23c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a74fc6258796b7724355d07fac71e335b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a74fc6258796b7724355d07fac71e335b">_petsc_shell_matrix_mult</a> (Mat mat, Vec arg, Vec dest)</td></tr>
<tr class="separator:a74fc6258796b7724355d07fac71e335b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0fc5357cfc5608df9c2ed47ae2c471"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#aca0fc5357cfc5608df9c2ed47ae2c471">_petsc_shell_matrix_mult_add</a> (Mat mat, Vec arg, Vec add, Vec dest)</td></tr>
<tr class="separator:aca0fc5357cfc5608df9c2ed47ae2c471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8568708754d996fda7f23f507577b4e9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a8568708754d996fda7f23f507577b4e9">_petsc_shell_matrix_get_diagonal</a> (Mat mat, Vec dest)</td></tr>
<tr class="separator:a8568708754d996fda7f23f507577b4e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5e0e279c8b33fdebb77bb1866667c69e"><td class="memItemLeft" align="right" valign="top">SLES&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a></td></tr>
<tr class="separator:a5e0e279c8b33fdebb77bb1866667c69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0962b22c0c4b93c85a0eb73f356d08"><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a></td></tr>
<tr class="separator:aec0962b22c0c4b93c85a0eb73f356d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab7a17b361ee3fc29048f828a3c2735"><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a></td></tr>
<tr class="separator:a8ab7a17b361ee3fc29048f828a3c2735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dce039d2a51416c1f7c6c3c281abe28"><td class="memItemLeft" align="right" valign="top">IS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a></td></tr>
<tr class="separator:a9dce039d2a51416c1f7c6c3c281abe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c04c198cbb2b5ad74b6e0565ec5cfb"><td class="memItemLeft" align="right" valign="top">IS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a></td></tr>
<tr class="separator:ac6c04c198cbb2b5ad74b6e0565ec5cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf9b5a6769afcb1bb671446a30acd467"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1">SubsetSolveMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a></td></tr>
<tr class="separator:aaf9b5a6769afcb1bb671446a30acd467"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br />
class libMesh::PetscLinearSolver&lt; T &gt;</h3>

<p>This class provides an interface to PETSc iterative solvers that is compatible with the <code><a class="el" href="namespacelibMesh.html">libMesh</a></code> <code>LinearSolver&lt;&gt;</code> </p>
<dl class="section author"><dt>Author</dt><dd>Benjamin Kirk </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2002-2007 </dd></dl>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00099">99</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="adb5daadc989c1fe71ec8d173adf0ed1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, std::pair&lt;unsigned int, unsigned int&gt; &gt; <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">libMesh::ReferenceCounter::Counts</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Data structure to log the information. The log is identified by the class name. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00109">109</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a47c322a43214968f8d1ea1ea8d1a27b1"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::<a class="el" href="classlibMesh_1_1PetscLinearSolver.html">PetscLinearSolver</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">libMesh::Parallel::Communicator</a> &amp;comm_in&#160;</td>
          <td class="paramname"><em>LIBMESH_CAN_DEFAULT_TO_COMMWORLD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. Initializes Petsc data structures </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00335">335</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>References <a class="el" href="linear__solver_8h_source.html#l00269">libMesh::LinearSolver&lt; T &gt;::_preconditioner_type</a>, <a class="el" href="enum__preconditioner__type_8h_source.html#l00032">libMesh::BLOCK_JACOBI_PRECOND</a>, <a class="el" href="enum__preconditioner__type_8h_source.html#l00039">libMesh::ILU_PRECOND</a>, and <a class="el" href="parallel__object_8h_source.html#l00093">libMesh::ParallelObject::n_processors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                                                                  :</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  LinearSolver&lt;T&gt;(comm_in),</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>(NULL),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>(NULL),</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>(<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a50719f74165b613ab929afd29b6d5f4a">n_processors</a>() == 1)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = <a class="code" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153">ILU_PRECOND</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = <a class="code" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e">BLOCK_JACOBI_PRECOND</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">libMesh::SUBSET_ZERO</a></div><div class="ttdoc">Set dofs outside the subset to zero. </div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00033">enum_subset_solve_mode.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a50719f74165b613ab929afd29b6d5f4a"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a50719f74165b613ab929afd29b6d5f4a">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00093">parallel_object.h:93</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153"><div class="ttname"><a href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153">libMesh::ILU_PRECOND</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__preconditioner__type_8h_source.html#l00039">enum_preconditioner_type.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e"><div class="ttname"><a href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e">libMesh::BLOCK_JACOBI_PRECOND</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__preconditioner__type_8h_source.html#l00032">enum_preconditioner_type.h:32</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e98c6de5eb553ba0262291ac49a8743"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::~<a class="el" href="classlibMesh_1_1PetscLinearSolver.html">PetscLinearSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00351">351</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ad3284c33fc49f7f37f013f2be6826ca3">clear</a> ();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ad3284c33fc49f7f37f013f2be6826ca3"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ad3284c33fc49f7f37f013f2be6826ca3">libMesh::PetscLinearSolver::clear</a></div><div class="ttdeci">virtual void clear() libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00108">petsc_linear_solver.C:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a53c040d15138a248ff0f1006aa42a23c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_create_complement_is </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec_in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates <code>_restrict_solve_to_is_complement</code> to contain all indices that are local in <code>vec_in</code>, except those that are contained in <code>_restrict_solve_to_is</code>. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00376">376</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>References <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, and <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,0,0)</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// No ISComplement in PETSc 2.3.3</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  libmesh_not_implemented();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>==NULL)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = ISComplement(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                              vec_in.first_local_index(),</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                              vec_in.last_local_index(),</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                              &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8568708754d996fda7f23f507577b4e9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_petsc_shell_matrix_get_diagonal </td>
          <td>(</td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal function if shell matrix mode is used. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l02015">2015</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel_8h_source.html#l00666">libMesh::Parallel::Communicator::get()</a>, <a class="el" href="classlibMesh_1_1ShellMatrix.html#a1516571b30e8da439c498ce0e4ac788c">libMesh::ShellMatrix&lt; T &gt;::get_diagonal()</a>, and <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>.</p>
<div class="fragment"><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;{</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="comment">/* Get the matrix context.  */</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordtype">void</span>* ctx;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  ierr = MatShellGetContext(mat,&amp;ctx);</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  <span class="comment">/* Get user shell matrix object.  */</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keyword">const</span> ShellMatrix&lt;T&gt;&amp; shell_matrix = *<span class="keyword">static_cast&lt;</span><span class="keyword">const </span>ShellMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(ctx);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <a class="code" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">CHKERRABORT</a>(shell_matrix.comm().get(), <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="comment">/* Make \p NumericVector instances around the vector.  */</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  PetscVector&lt;T&gt; dest_global(dest, shell_matrix.comm());</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="comment">/* Call the user function.  */</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  shell_matrix.get_diagonal(dest_global);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af28ebd91e2ae35aed69475e4af665fed"><div class="ttname"><a href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT</a></div><div class="ttdeci">CHKERRABORT(comm, ierr)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a74fc6258796b7724355d07fac71e335b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_petsc_shell_matrix_mult </td>
          <td>(</td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal function if shell matrix mode is used. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01961">1961</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel_8h_source.html#l00666">libMesh::Parallel::Communicator::get()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, and <a class="el" href="classlibMesh_1_1ShellMatrix.html#a090ec49ccc34e8d103eba352b66cdf31">libMesh::ShellMatrix&lt; T &gt;::vector_mult()</a>.</p>
<div class="fragment"><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;{</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="comment">/* Get the matrix context.  */</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordtype">void</span>* ctx;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  ierr = MatShellGetContext(mat,&amp;ctx);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;  <span class="comment">/* Get user shell matrix object.  */</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keyword">const</span> ShellMatrix&lt;T&gt;&amp; shell_matrix = *<span class="keyword">static_cast&lt;</span><span class="keyword">const </span>ShellMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(ctx);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  <a class="code" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">CHKERRABORT</a>(shell_matrix.comm().get(), <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>);</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  <span class="comment">/* Make \p NumericVector instances around the vectors.  */</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  PetscVector&lt;T&gt; arg_global(arg, shell_matrix.comm());</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  PetscVector&lt;T&gt; dest_global(dest, shell_matrix.comm());</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="comment">/* Call the user function.  */</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;  shell_matrix.vector_mult(dest_global,arg_global);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af28ebd91e2ae35aed69475e4af665fed"><div class="ttname"><a href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT</a></div><div class="ttdeci">CHKERRABORT(comm, ierr)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca0fc5357cfc5608df9c2ed47ae2c471"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_petsc_shell_matrix_mult_add </td>
          <td>(</td>
          <td class="paramtype">Mat&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>add</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal function if shell matrix mode is used. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01985">1985</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="parallel_8h_source.html#l00666">libMesh::Parallel::Communicator::get()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, and <a class="el" href="classlibMesh_1_1ShellMatrix.html#a754071de77d848c5481a42fd41fc5157">libMesh::ShellMatrix&lt; T &gt;::vector_mult_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;{</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="comment">/* Get the matrix context.  */</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordtype">void</span>* ctx;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  ierr = MatShellGetContext(mat,&amp;ctx);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <span class="comment">/* Get user shell matrix object.  */</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  <span class="keyword">const</span> ShellMatrix&lt;T&gt;&amp; shell_matrix = *<span class="keyword">static_cast&lt;</span><span class="keyword">const </span>ShellMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(ctx);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <a class="code" href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">CHKERRABORT</a>(shell_matrix.comm().get(), <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="comment">/* Make \p NumericVector instances around the vectors.  */</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  PetscVector&lt;T&gt; arg_global(arg, shell_matrix.comm());</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  PetscVector&lt;T&gt; dest_global(dest, shell_matrix.comm());</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  PetscVector&lt;T&gt; add_global(add, shell_matrix.comm());</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  <span class="keywordflow">if</span>(add!=arg)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      arg_global = add_global;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  <span class="comment">/* Call the user function.  */</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  shell_matrix.vector_mult_add(dest_global,arg_global);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af28ebd91e2ae35aed69475e4af665fed"><div class="ttname"><a href="namespacelibMesh.html#af28ebd91e2ae35aed69475e4af665fed">libMesh::CHKERRABORT</a></div><div class="ttdeci">CHKERRABORT(comm, ierr)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a005e7b0e81dbc5d604296fa441692d30"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a7ad10af8599548704f3938639a33b5ca">PetscInt</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_restrict_solve_to_is_local_size </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal method that returns the local size of <code>_restrict_solve_to_is</code>. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00361">361</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>References <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, and <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>.</p>
<div class="fragment"><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> s;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = ISGetLocalSize(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,&amp;s);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">return</span> s;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e66cc138b52e80e93a75e55315245ee"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::adjoint_solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Call the Petsc solver. It calls the method below, using the same matrix for the system and preconditioner matrices. </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1LinearSolver.html#a0ce183dd3df5e26ec78277e19a0e75fa">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00827">827</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__matrix_8C_source.html#l00931">libMesh::PetscMatrix&lt; T &gt;::close()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="namespacelibMesh_1_1TriangleWrapper.html#ae06da07f4c64d00ebefa55ce7f5c5e6b">libMesh::TriangleWrapper::init()</a>, <a class="el" href="petsc__matrix_8C_source.html#l00130">libMesh::PetscMatrix&lt; T &gt;::init()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="petsc__matrix_8h_source.html#l00368">libMesh::PetscMatrix&lt; T &gt;::mat()</a>, <a class="el" href="petsc__macro_8h_source.html#l00097">PetscBool</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00034">libMesh::SUBSET_COPY_RHS</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00035">libMesh::SUBSET_DONT_TOUCH</a>, and <a class="el" href="enum__subset__solve__mode_8h_source.html#l00033">libMesh::SUBSET_ZERO</a>.</p>
<div class="fragment"><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  PetscMatrix&lt;T&gt;* matrix   = cast_ptr&lt;PetscMatrix&lt;T&gt;*&gt;(&amp;matrix_in);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">// Note that the matrix and precond matrix are the same</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  PetscMatrix&lt;T&gt;* precond  = cast_ptr&lt;PetscMatrix&lt;T&gt;*&gt;(&amp;matrix_in);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  PetscVector&lt;T&gt;* solution = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;solution_in);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  PetscVector&lt;T&gt;* rhs      = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;rhs_in);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a> (matrix);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its=0, max_its = <span class="keyword">static_cast&lt;</span><a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a><span class="keyword">&gt;</span>(m_its);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  PetscReal final_resid=0.;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="comment">// Close the matrices and vectors in case this wasn&#39;t already done.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  matrix-&gt;close ();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  precond-&gt;close ();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  solution-&gt;close ();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  rhs-&gt;close ();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">//   // If matrix != precond, then this means we have specified a</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">//   // special preconditioner, so reset preconditioner type to PCMAT.</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">//   if (matrix != precond)</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">//     {</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">//       this-&gt;_preconditioner_type = USER_PRECOND;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="comment">//       this-&gt;set_petsc_preconditioner_type ();</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="comment">//     }</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="comment">// 2.1.x &amp; earlier style</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,2,0)</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      libmesh_not_implemented();</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">// Based on http://wolfgang.math.tamu.edu/svn/public/deal.II/branches/MATH676/2008/deal.II/lac/source/petsc_solver.cc, http://tccc.iesl.forth.gr/AMS_EPEAEK/Elements/doc/in_html/petsc/SLES/index.html</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  SLES sles;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  ierr = SLESCreate (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(), &amp;sles);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  ierr = SLESSetOperators (sles, matrix-&gt;mat(), precond-&gt;mat(), this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  KSP <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8f722acb8c35301ed1581726d4024d60">ksp</a>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  ierr = SLESGetKSP (sles, &amp;ksp);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  ierr = SLESSetUp (sles, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// See http://tccc.iesl.forth.gr/AMS_EPEAEK/Elements/doc/in_html/petsc/KSP/KSPSolveTrans.html#KSPSolveTrans</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  ierr = SLESSolveTrans (ksp, &amp;its);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">// 2.2.0</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#elif PETSC_VERSION_LESS_THAN(2,2,1)</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      libmesh_not_implemented();</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <span class="comment">// This was commented earlier but it looks like KSPSetOperators is supported</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <span class="comment">// after PETSc 2.2.0</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), precond-&gt;mat(),</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                         this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// Convergence is detected at iteration k if</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// ||r_k||_2 &lt; max(rtol*||b||_2 , abstol)</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="comment">// where r_k is the residual vector and b is the right-hand side.  Note that</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="comment">// it is the *maximum* of the two values, the larger of which will almost</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// always be rtol*||b||_2.</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                           tol,           <span class="comment">// rtol   = relative decrease in residual  (1.e-5)</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                           PETSC_DEFAULT, <span class="comment">// abstol = absolute convergence tolerance (1.e-50)</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                           PETSC_DEFAULT, <span class="comment">// dtol   = divergence tolerance           (1.e+5)</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                           max_its);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">// Set the solution vector to use</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  ierr = KSPSetSolution (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, solution-&gt;vec());</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// Set the RHS vector to use</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  ierr = KSPSetRhs (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec());</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  ierr = KSPSolveTranspose (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">// 2.2.1 &amp; newer style</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  Mat submat = NULL;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  Mat subprecond = NULL;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  Vec subrhs = NULL;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  Vec subsolution = NULL;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  VecScatter scatter = NULL;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  PetscMatrix&lt;Number&gt;* subprecond_matrix = NULL;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// Set operators.  Also restrict rhs and solution vector to</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// subdomain if neccessary.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_local_size = this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">_restrict_solve_to_is_local_size</a>();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subrhs);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      ierr = VecSetSizes(subrhs,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      ierr = VecSetFromOptions(subrhs);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subsolution);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      ierr = VecSetSizes(subsolution,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      ierr = VecSetFromOptions(subsolution);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>, subrhs,NULL, &amp;scatter);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      ierr = VecScatterBegin(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      ierr = VecScatterEnd(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      ierr = VecScatterBegin(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      ierr = VecScatterEnd(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                             PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      ierr = MatGetSubMatrix(precond-&gt;mat(),</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                             PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;subprecond);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                             MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      ierr = MatGetSubMatrix(precond-&gt;mat(),</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                             MAT_INITIAL_MATRIX,&amp;subprecond);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="comment">/* Since removing columns of the matrix changes the equation</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">         system, we will now change the right hand side to compensate</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">         for this.  Note that this is not necessary if \p SUBSET_ZERO</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">         has been selected.  */</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>!=<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is</a>(rhs_in);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_complement_local_size =</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            cast_int&lt;PetscInt&gt;(rhs_in.local_size()-is_local_size);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          Vec subvec1 = NULL;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          Mat submat1 = NULL;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          VecScatter scatter1 = NULL;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec1);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          ierr = VecSetSizes(subvec1,is_complement_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          ierr = VecSetFromOptions(subvec1);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>, subvec1,NULL, &amp;scatter1);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;          ierr = VecScatterBegin(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          ierr = VecScatterEnd(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;          ierr = VecScale(subvec1,-1.0);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                 PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;          ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                 MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          ierr = MatMultAdd(submat1,subvec1,subrhs,subrhs);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;          ierr = LibMeshVecScatterDestroy(&amp;scatter1);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;          ierr = LibMeshVecDestroy(&amp;subvec1);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          ierr = LibMeshMatDestroy(&amp;submat1);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond,</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                             this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <a class="code" href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a> ksp_reuse_preconditioner = this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? PETSC_TRUE : PETSC_FALSE;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      ierr = KSPSetReusePreconditioner(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, ksp_reuse_preconditioner);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          subprecond_matrix = <span class="keyword">new</span> PetscMatrix&lt;Number&gt;(subprecond,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                                      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(*subprecond_matrix);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), precond-&gt;mat(),</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                             this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), precond-&gt;mat());</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <a class="code" href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a> ksp_reuse_preconditioner = this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? PETSC_TRUE : PETSC_FALSE;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      ierr = KSPSetReusePreconditioner(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, ksp_reuse_preconditioner);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(matrix_in);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, tol, PETSC_DEFAULT,</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                           PETSC_DEFAULT, max_its);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="keywordflow">if</span>(_restrict_solve_to_is!=NULL)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      ierr = KSPSolveTranspose (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, subrhs, subsolution);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      ierr = KSPSolveTranspose (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">if</span>(_restrict_solve_to_is!=NULL)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>:</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          ierr = VecZeroEntries(solution-&gt;vec());</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a>:</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          ierr = VecCopy(rhs-&gt;vec(),solution-&gt;vec());</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">SUBSET_DONT_TOUCH</a>:</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          <span class="comment">/* Nothing to do here.  */</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;          libmesh_error_msg(<span class="stringliteral">&quot;Invalid subset solve mode = &quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        }</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      ierr = VecScatterBegin(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      ierr = VecScatterEnd(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      ierr = LibMeshVecScatterDestroy(&amp;scatter);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <span class="comment">/* Before we delete subprecond_matrix, we should give the</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">             _preconditioner a different matrix.  */</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(matrix_in);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          <span class="keyword">delete</span> subprecond_matrix;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          subprecond_matrix = NULL;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      ierr = LibMeshVecDestroy(&amp;subsolution);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      ierr = LibMeshVecDestroy(&amp;subrhs);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      ierr = LibMeshMatDestroy(&amp;submat);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      ierr = LibMeshMatDestroy(&amp;subprecond);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    }</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="comment">// return the # of its. and the final residual norm.</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">return</span> std::make_pair(its, final_resid);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8f722acb8c35301ed1581726d4024d60"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8f722acb8c35301ed1581726d4024d60">libMesh::PetscLinearSolver::ksp</a></div><div class="ttdeci">KSP ksp()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00234">petsc_linear_solver.h:234</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">libMesh::SUBSET_DONT_TOUCH</a></div><div class="ttdoc">Leaves dofs outside the subset unchanged. This is fastest, but also most confusing because it abandon...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00035">enum_subset_solve_mode.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">libMesh::SUBSET_ZERO</a></div><div class="ttdoc">Set dofs outside the subset to zero. </div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00033">enum_subset_solve_mode.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a53c040d15138a248ff0f1006aa42a23c"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">libMesh::PetscLinearSolver::_create_complement_is</a></div><div class="ttdeci">void _create_complement_is(const NumericVector&lt; T &gt; &amp;vec_in)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00376">petsc_linear_solver.h:376</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">libMesh::SUBSET_COPY_RHS</a></div><div class="ttdoc">Set dofs outside the subset to the value of the corresponding dofs of the right hand side...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00034">enum_subset_solve_mode.h:34</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a005e7b0e81dbc5d604296fa441692d30"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">libMesh::PetscLinearSolver::_restrict_solve_to_is_local_size</a></div><div class="ttdeci">PetscInt _restrict_solve_to_is_local_size(void) const </div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00361">petsc_linear_solver.h:361</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a851fb44823b601cd8502fd7688266c29"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">libMesh::LinearSolver::same_preconditioner</a></div><div class="ttdeci">bool same_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00287">linear_solver.h:287</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="petsc__macro_8h_html_a118393cd7c42d4cc73950defd0e32873"><div class="ttname"><a href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a></div><div class="ttdeci">EXTERN_C_FOR_PETSC_BEGIN EXTERN_C_FOR_PETSC_END typedef PetscTruth PetscBool</div><div class="ttdef"><b>Definition:</b> <a href="petsc__macro_8h_source.html#l00097">petsc_macro.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae800697a18767330e32c14cc1c06aa91"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::attach_preconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>preconditioner</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attaches a <a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a> object to be used </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00102">102</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>

<p>References <a class="el" href="libmesh_8C_source.html#l00246">libMesh::libMeshPrivateData::_is_initialized</a>, and <a class="el" href="enum__preconditioner__type_8h_source.html#l00042">libMesh::SHELL_PRECOND</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a>)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;Preconditioner must be attached before the solver is initialized!&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = <a class="code" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a2460dcbe1f3ff6aafe25b2132c466e0c">SHELL_PRECOND</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a> = preconditioner;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae32cb39661f0f330f8b2ce20725eff61a2460dcbe1f3ff6aafe25b2132c466e0c"><div class="ttname"><a href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a2460dcbe1f3ff6aafe25b2132c466e0c">libMesh::SHELL_PRECOND</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__preconditioner__type_8h_source.html#l00042">enum_preconditioner_type.h:42</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a97da17452484aa8121282f15248b8b9a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">libMesh::LinearSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00274">linear_solver.h:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dd8a3d8d7c1e04b3b7ace0e1378b33f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#af0a78fa0f592d2b8f515c69cabfaf529">UniquePtr</a>&lt; <a class="el" href="classlibMesh_1_1LinearSolver.html">LinearSolver</a>&lt; T &gt; &gt; <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">libMesh::Parallel::Communicator</a> &amp;&#160;</td>
          <td class="paramname"><em>comm_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a17745da36305535897ef6f57df9f6e01">SolverPackage</a>&#160;</td>
          <td class="paramname"><em>solver_package</em> = <code><a class="el" href="namespacelibMesh.html#a496c62248223cd940c7715932dd0dc2d">libMesh::default_solver_package</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds a <code><a class="el" href="classlibMesh_1_1LinearSolver.html">LinearSolver</a></code> using the linear solver package specified by <code>solver_package</code> </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00042">42</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="libmesh_8C_source.html#l00253">libMesh::EIGEN_SOLVERS</a>, <a class="el" href="libmesh_8C_source.html#l00255">libMesh::LASPACK_SOLVERS</a>, <a class="el" href="enum__solver__package_8h_source.html#l00034">libMesh::PETSC_SOLVERS</a>, and <a class="el" href="libmesh_8C_source.html#l00251">libMesh::TRILINOS_SOLVERS</a>.</p>

<p>Referenced by <a class="el" href="implicit__system_8C_source.html#l01398">libMesh::ImplicitSystem::get_linear_solver()</a>, and <a class="el" href="time__solver_8C_source.html#l00064">libMesh::TimeSolver::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">// Build the appropriate solver</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">switch</span> (solver_package)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#ifdef LIBMESH_HAVE_LASPACK</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#aeb2a777af969e03421c99c4afe9d68a0">LASPACK_SOLVERS</a>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">return</span> UniquePtr&lt;LinearSolver&lt;T&gt; &gt;(<span class="keyword">new</span> LaspackLinearSolver&lt;T&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>));</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#ifdef LIBMESH_HAVE_PETSC</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a17745da36305535897ef6f57df9f6e01a3a8fbb56fc5329954ccf3f2c4583db9e">PETSC_SOLVERS</a>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">return</span> UniquePtr&lt;LinearSolver&lt;T&gt; &gt;(<span class="keyword">new</span> PetscLinearSolver&lt;T&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#if defined(LIBMESH_HAVE_TRILINOS) &amp;&amp; (LIBMESH_TRILINOS_HAVE_AZTECOO)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#aa27e267f495ee0599f7cd8981c0cf7ad">TRILINOS_SOLVERS</a>:</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> UniquePtr&lt;LinearSolver&lt;T&gt; &gt;(<span class="keyword">new</span> AztecLinearSolver&lt;T&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#ifdef LIBMESH_HAVE_EIGEN</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#ae73defe502d02a0aa591555f4dd18dd4">EIGEN_SOLVERS</a>:</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">return</span> UniquePtr&lt;LinearSolver&lt;T&gt; &gt;(<span class="keyword">new</span> EigenSparseLinearSolver&lt;T&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      libmesh_error_msg(<span class="stringliteral">&quot;ERROR:  Unrecognized solver package: &quot;</span> &lt;&lt; solver_package);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">return</span> UniquePtr&lt;LinearSolver&lt;T&gt; &gt;();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a17745da36305535897ef6f57df9f6e01a3a8fbb56fc5329954ccf3f2c4583db9e"><div class="ttname"><a href="namespacelibMesh.html#a17745da36305535897ef6f57df9f6e01a3a8fbb56fc5329954ccf3f2c4583db9e">libMesh::PETSC_SOLVERS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__package_8h_source.html#l00034">enum_solver_package.h:34</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae73defe502d02a0aa591555f4dd18dd4"><div class="ttname"><a href="namespacelibMesh.html#ae73defe502d02a0aa591555f4dd18dd4">libMesh::EIGEN_SOLVERS</a></div><div class="ttdeci">EIGEN_SOLVERS</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00253">libmesh.C:253</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa27e267f495ee0599f7cd8981c0cf7ad"><div class="ttname"><a href="namespacelibMesh.html#aa27e267f495ee0599f7cd8981c0cf7ad">libMesh::TRILINOS_SOLVERS</a></div><div class="ttdeci">TRILINOS_SOLVERS</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00251">libmesh.C:251</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aeb2a777af969e03421c99c4afe9d68a0"><div class="ttname"><a href="namespacelibMesh.html#aeb2a777af969e03421c99c4afe9d68a0">libMesh::LASPACK_SOLVERS</a></div><div class="ttdeci">LASPACK_SOLVERS</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00255">libmesh.C:255</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3284c33fc49f7f37f013f2be6826ca3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Release all memory and clear data structures. </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1LinearSolver.html#a05866150ac7a96976f194e08fd7a8af8">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00108">108</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="libmesh_8C_source.html#l00246">libMesh::libMeshPrivateData::_is_initialized</a>, <a class="el" href="enum__preconditioner__type_8h_source.html#l00032">libMesh::BLOCK_JACOBI_PRECOND</a>, <a class="el" href="enum__solver__type_8h_source.html#l00040">libMesh::GMRES</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="enum__preconditioner__type_8h_source.html#l00039">libMesh::ILU_PRECOND</a>, <a class="el" href="libmesh_8C_source.html#l00265">libMesh::initialized()</a>, and <a class="el" href="libmesh__base_8h_source.html#l00088">libMesh::n_processors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">initialized</a>())</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">/* If we were restricted to some subset, this restriction must</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">         be removed and the subset index set destroyed.  */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = LibMeshISDestroy(&amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a> = NULL;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>!=NULL)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = LibMeshISDestroy(&amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a> = NULL;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,2,0)</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">// 2.1.x &amp; earlier style</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      ierr = SLESDestroy(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">// 2.2.0 &amp; newer style</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      ierr = LibMeshKSPDestroy(&amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="comment">// Mimic PETSc default solver and preconditioner</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a>           = <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7">GMRES</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a50719f74165b613ab929afd29b6d5f4a">n_processors</a>() == 1)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = <a class="code" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153">ILU_PRECOND</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = <a class="code" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e">BLOCK_JACOBI_PRECOND</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a6b64a30f2023ff38c662536f79a4451a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">libMesh::LinearSolver::_solver_type</a></div><div class="ttdeci">SolverType _solver_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00264">linear_solver.h:264</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_ac9d7de69910e031898f5786b61816f72"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">libMesh::LinearSolver::initialized</a></div><div class="ttdeci">bool initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00086">linear_solver.h:86</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7">libMesh::GMRES</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00040">enum_solver_type.h:40</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a50719f74165b613ab929afd29b6d5f4a"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a50719f74165b613ab929afd29b6d5f4a">libMesh::ParallelObject::n_processors</a></div><div class="ttdeci">processor_id_type n_processors() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00093">parallel_object.h:93</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153"><div class="ttname"><a href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a0b90d345d986c66179f3fbbb0782d153">libMesh::ILU_PRECOND</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__preconditioner__type_8h_source.html#l00039">enum_preconditioner_type.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a5e0e279c8b33fdebb77bb1866667c69e"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">libMesh::PetscLinearSolver::_sles</a></div><div class="ttdeci">SLES _sles</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00284">petsc_linear_solver.h:284</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e"><div class="ttname"><a href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61a25c9c72cb0b01f04e8a4a723774da35e">libMesh::BLOCK_JACOBI_PRECOND</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__preconditioner__type_8h_source.html#l00032">enum_preconditioner_type.h:32</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a97da17452484aa8121282f15248b8b9a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">libMesh::LinearSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00274">linear_solver.h:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20de1180df21bdc9e6ca6151ed4ffda9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::comm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>a reference to the <code><a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a></code> object used by this mesh. </dd></dl>

<p>Definition at line <a class="el" href="parallel__object_8h_source.html#l00087">87</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00105">libMesh::ParallelObject::_communicator</a>.</p>

<p>Referenced by <a class="el" href="petsc__diff__solver_8C_source.html#l00051">libMesh::__libmesh_petsc_diff_solver_monitor()</a>, <a class="el" href="petsc__diff__solver_8C_source.html#l00092">libMesh::__libmesh_petsc_diff_solver_residual()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00163">libMesh::__libmesh_petsc_snes_jacobian()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00264">libMesh::__libmesh_petsc_snes_postcheck()</a>, <a class="el" href="petsc__nonlinear__solver_8C_source.html#l00081">libMesh::__libmesh_petsc_snes_residual()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00204">libMesh::__libmesh_tao_equality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00257">libMesh::__libmesh_tao_equality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00094">libMesh::__libmesh_tao_gradient()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00146">libMesh::__libmesh_tao_hessian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00307">libMesh::__libmesh_tao_inequality_constraints()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00360">libMesh::__libmesh_tao_inequality_constraints_jacobian()</a>, <a class="el" href="tao__optimization__solver_8C_source.html#l00049">libMesh::__libmesh_tao_objective()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01403">libMesh::MeshRefinement::_coarsen_elements()</a>, <a class="el" href="exact__solution_8C_source.html#l00508">libMesh::ExactSolution::_compute_error()</a>, <a class="el" href="metis__partitioner_8C_source.html#l00062">libMesh::MetisPartitioner::_do_partition()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00091">libMesh::ParmetisPartitioner::_do_repartition()</a>, <a class="el" href="uniform__refinement__estimator_8C_source.html#l00086">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="boundary__info_8C_source.html#l01736">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00808">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l02015">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_get_diagonal()</a>, <a class="el" href="slepc__eigen__solver_8C_source.html#l00783">libMesh::SlepcEigenSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01961">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l01985">libMesh::PetscLinearSolver&lt; T &gt;::_petsc_shell_matrix_mult_add()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00154">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01515">libMesh::MeshRefinement::_refine_elements()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01596">libMesh::MeshRefinement::_smooth_flags()</a>, <a class="el" href="implicit__system_8C_source.html#l00207">libMesh::ImplicitSystem::add_matrix()</a>, <a class="el" href="system_8C_source.html#l00688">libMesh::System::add_vector()</a>, <a class="el" href="mesh__modification_8C_source.html#l00426">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00298">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l01121">libMesh::FEMSystem::assemble_qoi()</a>, <a class="el" href="mesh__communication__global__indices_8C_source.html#l00183">libMesh::MeshCommunication::assign_global_indices()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00635">libMesh::ParmetisPartitioner::assign_partitioning()</a>, <a class="el" href="dof__map_8C_source.html#l00230">libMesh::DofMap::attach_matrix()</a>, <a class="el" href="mesh__tools_8C_source.html#l00417">libMesh::MeshTools::bounding_box()</a>, <a class="el" href="equation__systems_8C_source.html#l00673">libMesh::EquationSystems::build_solution_vector()</a>, <a class="el" href="mesh__base_8C_source.html#l00505">libMesh::MeshBase::cache_elem_dims()</a>, <a class="el" href="system_8C_source.html#l01425">libMesh::System::calculate_norm()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01596">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01473">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01364">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00099">libMesh::Problem_Interface::computeF()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00149">libMesh::Problem_Interface::computeJacobian()</a>, <a class="el" href="trilinos__nox__nonlinear__solver_8C_source.html#l00205">libMesh::Problem_Interface::computePreconditioner()</a>, <a class="el" href="mesh__tools_8C_source.html#l00978">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="mesh__communication_8C_source.html#l01097">libMesh::MeshCommunication::delete_remote_elements()</a>, <a class="el" href="dof__map_8C_source.html#l00845">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00757">DMlibMeshFunction()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00827">DMlibMeshJacobian()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00071">DMlibMeshSetSystem_libMesh()</a>, <a class="el" href="petscdmlibmeshimpl_8C_source.html#l00920">DMVariableBounds_libMesh()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00418">libMesh::MeshRefinement::eliminate_unrefined_patches()</a>, <a class="el" href="weighted__patch__recovery__estimator_8C_source.html#l00044">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00131">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00053">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00069">libMesh::AdjointRefinementEstimator::estimate_error()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00453">libMesh::MeshRefinement::flag_elements_by_elem_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00045">libMesh::MeshRefinement::flag_elements_by_error_fraction()</a>, <a class="el" href="mesh__refinement__flagging_8C_source.html#l00245">libMesh::MeshRefinement::flag_elements_by_nelem_target()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00241">libMesh::for()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00178">libMesh::CondensedEigenSystem::get_eigenpair()</a>, <a class="el" href="implicit__system_8C_source.html#l01398">libMesh::ImplicitSystem::get_linear_solver()</a>, <a class="el" href="equation__systems_8C_source.html#l00886">libMesh::EquationSystems::get_solution()</a>, <a class="el" href="location__maps_8C_source.html#l00050">libMesh::LocationMap&lt; T &gt;::init()</a>, <a class="el" href="topology__map_8C_source.html#l00037">libMesh::TopologyMap::init()</a>, <a class="el" href="time__solver_8C_source.html#l00064">libMesh::TimeSolver::init()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00118">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="eigen__system_8C_source.html#l00124">libMesh::EigenSystem::init_data()</a>, <a class="el" href="eigen__system_8C_source.html#l00143">libMesh::EigenSystem::init_matrices()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00205">libMesh::ParmetisPartitioner::initialize()</a>, <a class="el" href="optimization__system_8C_source.html#l00091">libMesh::OptimizationSystem::initialize_equality_constraints_storage()</a>, <a class="el" href="optimization__system_8C_source.html#l00125">libMesh::OptimizationSystem::initialize_inequality_constraints_storage()</a>, <a class="el" href="mesh__tools_8C_source.html#l01279">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01547">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00845">libMesh::ParallelMesh::libmesh_assert_valid_parallel_flags()</a>, <a class="el" href="mesh__tools_8C_source.html#l01302">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01387">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01463">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00138">libMesh::MeshRefinement::limit_level_mismatch_at_edge()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00039">libMesh::MeshRefinement::limit_level_mismatch_at_node()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00279">libMesh::MeshRefinement::limit_overrefined_boundary()</a>, <a class="el" href="mesh__refinement__smoothing_8C_source.html#l00347">libMesh::MeshRefinement::limit_underrefined_boundary()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00859">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__communication_8C_source.html#l00963">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00829">libMesh::MeshRefinement::make_flags_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l00946">libMesh::MeshCommunication::make_node_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01027">libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01059">libMesh::MeshCommunication::make_nodes_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l01208">libMesh::MeshRefinement::make_refinement_compatible()</a>, <a class="el" href="fem__system_8C_source.html#l01054">libMesh::FEMSystem::mesh_position_set()</a>, <a class="el" href="mesh__serializer_8C_source.html#l00027">libMesh::MeshSerializer::MeshSerializer()</a>, <a class="el" href="parallel__mesh_8C_source.html#l01233">libMesh::ParallelMesh::n_active_elem()</a>, <a class="el" href="mesh__tools_8C_source.html#l00590">libMesh::MeshTools::n_active_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01299">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01321">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="condensed__eigen__system_8C_source.html#l00081">libMesh::CondensedEigenSystem::n_global_non_condensed_dofs()</a>, <a class="el" href="mesh__tools_8C_source.html#l00626">libMesh::MeshTools::n_levels()</a>, <a class="el" href="boundary__info_8C_source.html#l01344">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="mesh__tools_8C_source.html#l00678">libMesh::MeshTools::n_p_levels()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00178">libMesh::ParallelMesh::parallel_max_elem_id()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00204">libMesh::ParallelMesh::parallel_max_node_id()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00165">libMesh::ParallelMesh::parallel_n_elem()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00191">libMesh::ParallelMesh::parallel_n_nodes()</a>, <a class="el" href="partitioner_8C_source.html#l00055">libMesh::Partitioner::partition()</a>, <a class="el" href="partitioner_8C_source.html#l00187">libMesh::Partitioner::partition_unpartitioned_elements()</a>, <a class="el" href="petsc__auto__fieldsplit_8C_source.html#l00060">libMesh::petsc_auto_fieldsplit()</a>, <a class="el" href="system_8C_source.html#l02097">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02202">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01994">libMesh::System::point_value()</a>, <a class="el" href="mesh__base_8C_source.html#l00127">libMesh::MeshBase::prepare_for_use()</a>, <a class="el" href="system__projection_8C_source.html#l00511">libMesh::System::project_vector()</a>, <a class="el" href="nemesis__io_8C_source.html#l00136">libMesh::Nemesis_IO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01041">libMesh::XdrIO::read()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="system__io_8C_source.html#l01099">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l01632">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01478">libMesh::XdrIO::read_serialized_bcs()</a>, <a class="el" href="system__io_8C_source.html#l00784">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01222">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l00713">libMesh::System::read_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l01402">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01556">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01176">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01147">libMesh::System::read_serialized_vector()</a>, <a class="el" href="mesh__base_8C_source.html#l00402">libMesh::MeshBase::recalculate_n_partitions()</a>, <a class="el" href="partitioner_8C_source.html#l00439">libMesh::Partitioner::set_node_processor_ids()</a>, <a class="el" href="dof__map_8C_source.html#l00289">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="mesh__base_8C_source.html#l00223">libMesh::MeshBase::subdomain_ids()</a>, <a class="el" href="boundary__info_8C_source.html#l00128">libMesh::BoundaryInfo::sync()</a>, <a class="el" href="parallel__ghost__sync_8h_source.html#l00341">libMesh::Parallel::sync_element_data_by_parent_id()</a>, <a class="el" href="parallel__ghost__sync_8h_source.html#l00459">libMesh::Parallel::sync_node_data_by_element_id()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00342">libMesh::MeshRefinement::test_level_one()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00425">libMesh::MeshRefinement::test_unflagged()</a>, <a class="el" href="mesh__tools_8C_source.html#l00315">libMesh::MeshTools::total_weight()</a>, <a class="el" href="namebased__io_8C_source.html#l00289">libMesh::NameBasedIO::write()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00077">libMesh::CheckpointIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00157">libMesh::XdrIO::write()</a>, <a class="el" href="legacy__xdr__io_8C_source.html#l00659">libMesh::LegacyXdrIO::write_mesh()</a>, <a class="el" href="system__io_8C_source.html#l02100">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00831">libMesh::XdrIO::write_serialized_bcs()</a>, <a class="el" href="system__io_8C_source.html#l01806">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00344">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00672">libMesh::XdrIO::write_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l00919">libMesh::XdrIO::write_serialized_nodesets()</a>, and <a class="el" href="diva__io_8C_source.html#l00053">libMesh::DivaIO::write_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>; }</div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00105">parallel_object.h:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c0a2d3d3c531f9f069b0d623d4ace0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::disable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="reference__counter_8C_source.html#l00106">106</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00133">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00133">reference_counter.h:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86837c50216b2ddb800b3836d2a08c09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::enable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Methods to enable/disable the reference counter output from <a class="el" href="classlibMesh_1_1ReferenceCounter.html#a6f46edb253f11a90bfc5f824b45ed596">print_info()</a> </p>

<p>Definition at line <a class="el" href="reference__counter_8C_source.html#l00100">100</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00133">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00133">reference_counter.h:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa2a93e69d2fc6ca23aac0500d356e6ba"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38db">LinearConvergenceReason</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::get_converged_reason </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the solver's convergence flag </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#a580c58934e693b85caff32c27d602045">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01921">1921</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="enum__convergence__flags_8h_source.html#l00035">libMesh::CONVERGED_ATOL</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00033">libMesh::CONVERGED_ATOL_NORMAL</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00038">libMesh::CONVERGED_CG_CONSTRAINED</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00037">libMesh::CONVERGED_CG_NEG_CURVE</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00040">libMesh::CONVERGED_HAPPY_BREAKDOWN</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00052">libMesh::CONVERGED_ITERATING</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00036">libMesh::CONVERGED_ITS</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00034">libMesh::CONVERGED_RTOL</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00032">libMesh::CONVERGED_RTOL_NORMAL</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00039">libMesh::CONVERGED_STEP_LENGTH</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00045">libMesh::DIVERGED_BREAKDOWN</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00046">libMesh::DIVERGED_BREAKDOWN_BICG</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00044">libMesh::DIVERGED_DTOL</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00050">libMesh::DIVERGED_INDEFINITE_MAT</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00048">libMesh::DIVERGED_INDEFINITE_PC</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00043">libMesh::DIVERGED_ITS</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00049">libMesh::DIVERGED_NAN</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00047">libMesh::DIVERGED_NONSYMMETRIC</a>, <a class="el" href="enum__convergence__flags_8h_source.html#l00042">libMesh::DIVERGED_NULL</a>, <a class="el" href="libmesh__common_8h_source.html#l00232">libMesh::err</a>, and <a class="el" href="enum__convergence__flags_8h_source.html#l00054">libMesh::UNKNOWN_FLAG</a>.</p>
<div class="fragment"><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;  KSPConvergedReason reason;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  KSPGetConvergedReason(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;reason);</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <span class="keywordflow">switch</span>(reason)</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    {</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="preprocessor">#if !PETSC_VERSION_LESS_THAN(3,2,0)</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_RTOL_NORMAL     : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba98ad07c434c6fdf1b9690d6f0f5b7f80">CONVERGED_RTOL_NORMAL</a>;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_ATOL_NORMAL     : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba4bd483270e842c602fa68eab541fb150">CONVERGED_ATOL_NORMAL</a>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_RTOL            : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba28f53dd0fb763e37f311357d0f6703bd">CONVERGED_RTOL</a>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_ATOL            : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba677b64cd446f261c0226d162b9623025">CONVERGED_ATOL</a>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_ITS             : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba363a76eac28ebf3221b85b03fb2db2b5">CONVERGED_ITS</a>;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_CG_NEG_CURVE    : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba4432aeab429ab4d4f5dfeda0584292f3">CONVERGED_CG_NEG_CURVE</a>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_CG_CONSTRAINED  : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba78adfd85a65e6119e59c9418ac96ee94">CONVERGED_CG_CONSTRAINED</a>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_STEP_LENGTH     : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba8a98bd89ac4641bcfdd6c00ac5a67fc1">CONVERGED_STEP_LENGTH</a>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_HAPPY_BREAKDOWN : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba0073e5418820ab6fa7125d1927c45f64">CONVERGED_HAPPY_BREAKDOWN</a>;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_NULL             : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba74cacce4f539517fc8a1695ad9c38f90">DIVERGED_NULL</a>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_ITS              : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba43bfa5625c4ac9ed807795d23f4c9936">DIVERGED_ITS</a>;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_DTOL             : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbad6b2420d04cfdd39d02a4f86203985f7">DIVERGED_DTOL</a>;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_BREAKDOWN        : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbaaccdf90b2c5f132a17a0a168c680d444">DIVERGED_BREAKDOWN</a>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_BREAKDOWN_BICG   : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbab2362b6d1023e6a616755130aca1945a">DIVERGED_BREAKDOWN_BICG</a>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_NONSYMMETRIC     : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba6039d46ee8d5632b7ad4fd4a42976cc9">DIVERGED_NONSYMMETRIC</a>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_INDEFINITE_PC    : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba82e0602bffa0115fa840342e490d9148">DIVERGED_INDEFINITE_PC</a>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,4,0)</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_NAN              : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba56979839a3ca4caa7b6ee6df09b46b24">DIVERGED_NAN</a>;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_NANORINF         : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba56979839a3ca4caa7b6ee6df09b46b24">DIVERGED_NAN</a>;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">case</span> KSP_DIVERGED_INDEFINITE_MAT   : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbab82b3835e506e5a2e2b7b61a968e7aea">DIVERGED_INDEFINITE_MAT</a>;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordflow">case</span> KSP_CONVERGED_ITERATING       : <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba6ac6346208b347333fcc49f6a1342cfe">CONVERGED_ITERATING</a>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">default</span> :</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;Unknown convergence flag!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbac36ccfe01adde260c065f98db8f2e3f6">UNKNOWN_FLAG</a>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba677b64cd446f261c0226d162b9623025"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba677b64cd446f261c0226d162b9623025">libMesh::CONVERGED_ATOL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00035">enum_convergence_flags.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba98ad07c434c6fdf1b9690d6f0f5b7f80"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba98ad07c434c6fdf1b9690d6f0f5b7f80">libMesh::CONVERGED_RTOL_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00032">enum_convergence_flags.h:32</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba6ac6346208b347333fcc49f6a1342cfe"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba6ac6346208b347333fcc49f6a1342cfe">libMesh::CONVERGED_ITERATING</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00052">enum_convergence_flags.h:52</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba4bd483270e842c602fa68eab541fb150"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba4bd483270e842c602fa68eab541fb150">libMesh::CONVERGED_ATOL_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00033">enum_convergence_flags.h:33</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba6039d46ee8d5632b7ad4fd4a42976cc9"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba6039d46ee8d5632b7ad4fd4a42976cc9">libMesh::DIVERGED_NONSYMMETRIC</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00047">enum_convergence_flags.h:47</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba74cacce4f539517fc8a1695ad9c38f90"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba74cacce4f539517fc8a1695ad9c38f90">libMesh::DIVERGED_NULL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00042">enum_convergence_flags.h:42</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba363a76eac28ebf3221b85b03fb2db2b5"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba363a76eac28ebf3221b85b03fb2db2b5">libMesh::CONVERGED_ITS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00036">enum_convergence_flags.h:36</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dbab2362b6d1023e6a616755130aca1945a"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbab2362b6d1023e6a616755130aca1945a">libMesh::DIVERGED_BREAKDOWN_BICG</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00046">enum_convergence_flags.h:46</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba82e0602bffa0115fa840342e490d9148"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba82e0602bffa0115fa840342e490d9148">libMesh::DIVERGED_INDEFINITE_PC</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00048">enum_convergence_flags.h:48</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba4432aeab429ab4d4f5dfeda0584292f3"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba4432aeab429ab4d4f5dfeda0584292f3">libMesh::CONVERGED_CG_NEG_CURVE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00037">enum_convergence_flags.h:37</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00232">libmesh_common.h:232</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dbac36ccfe01adde260c065f98db8f2e3f6"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbac36ccfe01adde260c065f98db8f2e3f6">libMesh::UNKNOWN_FLAG</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00054">enum_convergence_flags.h:54</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba56979839a3ca4caa7b6ee6df09b46b24"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba56979839a3ca4caa7b6ee6df09b46b24">libMesh::DIVERGED_NAN</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00049">enum_convergence_flags.h:49</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dbab82b3835e506e5a2e2b7b61a968e7aea"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbab82b3835e506e5a2e2b7b61a968e7aea">libMesh::DIVERGED_INDEFINITE_MAT</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00050">enum_convergence_flags.h:50</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dbaaccdf90b2c5f132a17a0a168c680d444"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbaaccdf90b2c5f132a17a0a168c680d444">libMesh::DIVERGED_BREAKDOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00045">enum_convergence_flags.h:45</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dbad6b2420d04cfdd39d02a4f86203985f7"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dbad6b2420d04cfdd39d02a4f86203985f7">libMesh::DIVERGED_DTOL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00044">enum_convergence_flags.h:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba0073e5418820ab6fa7125d1927c45f64"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba0073e5418820ab6fa7125d1927c45f64">libMesh::CONVERGED_HAPPY_BREAKDOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00040">enum_convergence_flags.h:40</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba43bfa5625c4ac9ed807795d23f4c9936"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba43bfa5625c4ac9ed807795d23f4c9936">libMesh::DIVERGED_ITS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00043">enum_convergence_flags.h:43</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba78adfd85a65e6119e59c9418ac96ee94"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba78adfd85a65e6119e59c9418ac96ee94">libMesh::CONVERGED_CG_CONSTRAINED</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00038">enum_convergence_flags.h:38</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba8a98bd89ac4641bcfdd6c00ac5a67fc1"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba8a98bd89ac4641bcfdd6c00ac5a67fc1">libMesh::CONVERGED_STEP_LENGTH</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00039">enum_convergence_flags.h:39</a></div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38dba28f53dd0fb763e37f311357d0f6703bd"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38dba28f53dd0fb763e37f311357d0f6703bd">libMesh::CONVERGED_RTOL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00034">enum_convergence_flags.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a103b37125ae9eaaadf6f7854df17faa2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::ReferenceCounter::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gets a string containing the reference information. </p>

<p>Definition at line <a class="el" href="reference__counter_8C_source.html#l00047">47</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00114">libMesh::ReferenceCounter::_counts</a>, and <a class="el" href="elem__quality_8C_source.html#l00039">libMesh::Quality::name()</a>.</p>

<p>Referenced by <a class="el" href="reference__counter_8C_source.html#l00088">libMesh::ReferenceCounter::print_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_REFERENCE_COUNTING) &amp;&amp; defined(DEBUG)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::ostringstream oss;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  oss &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;| Reference count information                                                |\n&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">for</span> (Counts::iterator it = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>.begin();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       it != <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>.end(); ++it)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keyword">const</span> std::string <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>(it-&gt;first);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> creations    = it-&gt;second.first;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> destructions = it-&gt;second.second;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      oss &lt;&lt; <span class="stringliteral">&quot;| &quot;</span> &lt;&lt; <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a> &lt;&lt; <span class="stringliteral">&quot; reference count information:\n&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;|  Creations:    &quot;</span> &lt;&lt; creations    &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;|  Destructions: &quot;</span> &lt;&lt; destructions &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  oss &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00039">elem_quality.C:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00114">reference_counter.h:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37641e5e49a89c36098322f1e5b1f0d8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::get_initial_residual </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns just the initial residual for the solve just completed with this interface. Use this method instead of the one above if you just want the starting residual and not the entire history. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01807">1807</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="libmesh__common_8h_source.html#l00232">libMesh::err</a>, and <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>.</p>
<div class="fragment"><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;{</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = 0;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its  = 0;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <span class="comment">// Fill the residual history vector with the residual norms</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">// Note that GetResidualHistory() does not copy any values, it</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// simply sets the pointer p.  Note that for some Krylov subspace</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">// methods, the number of residuals returned in the history</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">// vector may be different from what you are expecting.  For</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="comment">// example, TFQMR returns two residual values per iteration step.</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  PetscReal* p;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  ierr = KSPGetResidualHistory(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;p, &amp;its);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="comment">// Check no residual history</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">if</span> (its == 0)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;No iterations have been performed, returning 0.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">// Otherwise, return the value pointed to by p.</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="keywordflow">return</span> *p;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00232">libmesh_common.h:232</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d8c73be13b0e349132fbd2f1a7e0efc"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::get_residual_history </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>hist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the input vector with the sequence of residual norms from the latest iterative solve. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01774">1774</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>.</p>
<div class="fragment"><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;{</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = 0;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its  = 0;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <span class="comment">// Fill the residual history vector with the residual norms</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <span class="comment">// Note that GetResidualHistory() does not copy any values, it</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <span class="comment">// simply sets the pointer p.  Note that for some Krylov subspace</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// methods, the number of residuals returned in the history</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="comment">// vector may be different from what you are expecting.  For</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="comment">// example, TFQMR returns two residual values per iteration step.</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  PetscReal* p;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  ierr = KSPGetResidualHistory(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;p, &amp;its);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">// Check for early return</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="keywordflow">if</span> (its == 0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">// Create space to store the result</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  hist.resize(its);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="comment">// Copy history into the vector provided by the user.</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> i=0; i&lt;its; ++i)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    {</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      hist[i] = *p;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      p++;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a397b977d2247de8e923032a56d0c4b36"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::get_same_preconditioner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>same_preconditioner, which indicates if we reuse the same preconditioner for subsequent solves. </dd></dl>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00324">324</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a851fb44823b601cd8502fd7688266c29"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">libMesh::LinearSolver::same_preconditioner</a></div><div class="ttdeci">bool same_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00287">linear_solver.h:287</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4d69475c6ae8e441306e90e57d755ced"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_constructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Increments the construction counter. Should be called in the constructor of any derived class that will be reference counted. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00159">159</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00114">libMesh::ReferenceCounter::_counts</a>, <a class="el" href="elem__quality_8C_source.html#l00039">libMesh::Quality::name()</a>, and <a class="el" href="threads_8C_source.html#l00048">libMesh::Threads::spin_mtx</a>.</p>

<p>Referenced by <a class="el" href="reference__counted__object_8h_source.html#l00074">libMesh::ReferenceCountedObject&lt; RBParametrized &gt;::ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  Threads::spin_mutex::scoped_lock lock(<a class="code" href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">Threads::spin_mtx</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt;&amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  p.first++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00039">elem_quality.C:39</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_aba1ae5c24686d2cd2fc7ccdc9537c4f5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">libMesh::Threads::spin_mtx</a></div><div class="ttdeci">spin_mutex spin_mtx</div><div class="ttdef"><b>Definition:</b> <a href="threads_8C_source.html#l00048">threads.C:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00114">reference_counter.h:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f8ca3935940b9b1a60f7645e856f2e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_destructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Increments the destruction counter. Should be called in the destructor of any derived class that will be reference counted. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00172">172</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00114">libMesh::ReferenceCounter::_counts</a>, <a class="el" href="elem__quality_8C_source.html#l00039">libMesh::Quality::name()</a>, and <a class="el" href="threads_8C_source.html#l00048">libMesh::Threads::spin_mtx</a>.</p>

<p>Referenced by <a class="el" href="reference__counted__object_8h_source.html#l00101">libMesh::ReferenceCountedObject&lt; RBParametrized &gt;::~ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  Threads::spin_mutex::scoped_lock lock(<a class="code" href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">Threads::spin_mtx</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt;&amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  p.second++;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00039">elem_quality.C:39</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Threads_html_aba1ae5c24686d2cd2fc7ccdc9537c4f5"><div class="ttname"><a href="namespacelibMesh_1_1Threads.html#aba1ae5c24686d2cd2fc7ccdc9537c4f5">libMesh::Threads::spin_mtx</a></div><div class="ttdeci">spin_mutex spin_mtx</div><div class="ttdef"><b>Definition:</b> <a href="threads_8C_source.html#l00048">threads.C:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00114">reference_counter.h:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8fa06334f777e9c90c96d69a052985e5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::init </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize data structures if not done so already. Assigns a name, which is turned into an underscore-separated prefix for the underlying KSP object. </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#a4c62150396edb7dc89d572b30e266a99">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00163">163</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__linear__solver_8C_source.html#l00064">libMesh::__libmesh_petsc_preconditioner_apply()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l00051">libMesh::__libmesh_petsc_preconditioner_setup()</a>, <a class="el" href="libmesh_8C_source.html#l00246">libMesh::libMeshPrivateData::_is_initialized</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="libmesh_8C_source.html#l00265">libMesh::initialized()</a>, and <a class="el" href="petsc__preconditioner_8C_source.html#l00118">libMesh::PetscPreconditioner&lt; T &gt;::set_petsc_preconditioner_type()</a>.</p>

<p>Referenced by <a class="el" href="petsc__linear__solver_8h_source.html#l00234">libMesh::PetscLinearSolver&lt; T &gt;::ksp()</a>, and <a class="el" href="petsc__linear__solver_8h_source.html#l00227">libMesh::PetscLinearSolver&lt; T &gt;::pc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// Initialize the data structures if not done so already.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">initialized</a>())</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// 2.1.x &amp; earlier style</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,2,0)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="comment">// Create the linear solver context</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      ierr = SLESCreate (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(), &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">// Create the Krylov subspace &amp; preconditioner contexts</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      ierr = SLESGetKSP       (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      ierr = SLESGetPC        (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">// Set user-specified  solver and preconditioner types</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">set_petsc_solver_type</a>();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// Set the options from user-input</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// Set runtime options, e.g.,</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">//      -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">//  These options will override those specified above as long as</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">//  SLESSetFromOptions() is called _after_ any other customization</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">//  routines.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      ierr = SLESSetFromOptions (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// 2.2.0 &amp; newer style</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="comment">// Create the linear solver context</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      ierr = KSPCreate (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(), &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          ierr = KSPSetOptionsPrefix(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">// Create the preconditioner context</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      ierr = KSPGetPC        (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">// Set user-specified  solver and preconditioner types</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">set_petsc_solver_type</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <span class="comment">// If the SolverConfiguration object is provided, use it to set</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">// options during solver initialization.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>-&gt;<a class="code" href="classlibMesh_1_1SolverConfiguration.html#a9162128478dce78d7d8befc22b326225">set_options_during_init</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">// Set the options from user-input</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">// Set runtime options, e.g.,</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="comment">//      -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">//  These options will override those specified above as long as</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="comment">//  KSPSetFromOptions() is called _after_ any other customization</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">//  routines.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      ierr = KSPSetFromOptions (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">// Not sure if this is necessary, or if it is already handled by KSPSetFromOptions?</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">// NOT NECESSARY!!!!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">//ierr = PCSetFromOptions (_pc);</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">//LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="comment">// Have the Krylov subspace method use our good initial guess</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">// rather than 0, unless the user requested a KSPType of</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">// preonly, which complains if asked to use initial guesses.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,0,0) || !PETSC_RELEASE_LESS_THAN(3,4,0)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Pre-3.0 and petsc-dev (as of October 2012) use non-const versions</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      KSPType ksp_type;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keyword">const</span> KSPType ksp_type;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      ierr = KSPGetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;ksp_type);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (strcmp(ksp_type, <span class="stringliteral">&quot;preonly&quot;</span>))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          ierr = KSPSetInitialGuessNonzero (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, PETSC_TRUE);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">// Notify PETSc of location to store residual history.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">// This needs to be called before any solves, since</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// it sets the residual history length to zero.  The default</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="comment">// behavior is for PETSc to allocate (internally) an array</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="comment">// of size 1000 to hold the residual norm history.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      ierr = KSPSetResidualHistory(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                   PETSC_NULL,   <span class="comment">// pointer to the array which holds the history</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                   PETSC_DECIDE, <span class="comment">// size of the array holding the history</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                   PETSC_TRUE);  <span class="comment">// Whether or not to reset the history for each solve.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="classlibMesh_1_1PetscPreconditioner.html#aab69801de7b38fc74cf110baa0bcde9b">PetscPreconditioner&lt;T&gt;::set_petsc_preconditioner_type</a>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">//If there is a preconditioner object we need to set the internal setup and apply routines</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          PCShellSetContext(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,(<span class="keywordtype">void</span>*)this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          PCShellSetSetUp(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,<a class="code" href="namespacelibMesh.html#a0ad4171647357ca5a2ffacb1c8ca5c6a">__libmesh_petsc_preconditioner_setup</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          PCShellSetApply(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,<a class="code" href="namespacelibMesh.html#ae6c236ad49e5a5d8ad7f42d3f16b553e">__libmesh_petsc_preconditioner_apply</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00039">elem_quality.C:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_ac9d7de69910e031898f5786b61816f72"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">libMesh::LinearSolver::initialized</a></div><div class="ttdeci">bool initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00086">linear_solver.h:86</a></div></div>
<div class="ttc" id="classlibMesh_1_1SolverConfiguration_html_a9162128478dce78d7d8befc22b326225"><div class="ttname"><a href="classlibMesh_1_1SolverConfiguration.html#a9162128478dce78d7d8befc22b326225">libMesh::SolverConfiguration::set_options_during_init</a></div><div class="ttdeci">virtual void set_options_during_init()</div><div class="ttdef"><b>Definition:</b> <a href="solver__configuration_8h_source.html#l00058">solver_configuration.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a5e0e279c8b33fdebb77bb1866667c69e"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">libMesh::PetscLinearSolver::_sles</a></div><div class="ttdeci">SLES _sles</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00284">petsc_linear_solver.h:284</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_aa8d4f205b150f8ca380e3338af168237"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">libMesh::LinearSolver::_solver_configuration</a></div><div class="ttdeci">SolverConfiguration * _solver_configuration</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00293">linear_solver.h:293</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a7ba2130af69add0da3a7526c79095090"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">libMesh::PetscLinearSolver::set_petsc_solver_type</a></div><div class="ttdeci">void set_petsc_solver_type()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01837">petsc_linear_solver.C:1837</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aec0962b22c0c4b93c85a0eb73f356d08"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">libMesh::PetscLinearSolver::_pc</a></div><div class="ttdeci">PC _pc</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00291">petsc_linear_solver.h:291</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0ad4171647357ca5a2ffacb1c8ca5c6a"><div class="ttname"><a href="namespacelibMesh.html#a0ad4171647357ca5a2ffacb1c8ca5c6a">libMesh::__libmesh_petsc_preconditioner_setup</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_setup(void *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00051">petsc_linear_solver.C:51</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscPreconditioner_html_aab69801de7b38fc74cf110baa0bcde9b"><div class="ttname"><a href="classlibMesh_1_1PetscPreconditioner.html#aab69801de7b38fc74cf110baa0bcde9b">libMesh::PetscPreconditioner::set_petsc_preconditioner_type</a></div><div class="ttdeci">static void set_petsc_preconditioner_type(const PreconditionerType &amp;preconditioner_type, PC &amp;pc)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00118">petsc_preconditioner.C:118</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae6c236ad49e5a5d8ad7f42d3f16b553e"><div class="ttname"><a href="namespacelibMesh.html#ae6c236ad49e5a5d8ad7f42d3f16b553e">libMesh::__libmesh_petsc_preconditioner_apply</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_apply(void *ctx, Vec x, Vec y)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00064">petsc_linear_solver.C:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a97da17452484aa8121282f15248b8b9a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">libMesh::LinearSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00274">linear_solver.h:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd759dad2438c6fb10cca1caecb3b68a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1PetscMatrix.html">PetscMatrix</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize data structures if not done so already plus much more </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00288">288</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__linear__solver_8C_source.html#l00064">libMesh::__libmesh_petsc_preconditioner_apply()</a>, <a class="el" href="petsc__linear__solver_8C_source.html#l00051">libMesh::__libmesh_petsc_preconditioner_setup()</a>, <a class="el" href="libmesh_8C_source.html#l00246">libMesh::libMeshPrivateData::_is_initialized</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="libmesh_8C_source.html#l00265">libMesh::initialized()</a>, <a class="el" href="petsc__matrix_8h_source.html#l00368">libMesh::PetscMatrix&lt; T &gt;::mat()</a>, and <a class="el" href="petsc__preconditioner_8C_source.html#l00118">libMesh::PetscPreconditioner&lt; T &gt;::set_petsc_preconditioner_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// Initialize the data structures if not done so already.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">initialized</a>())</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment">// 2.1.x &amp; earlier style</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,2,0)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      <span class="comment">// Create the linear solver context</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      ierr = SLESCreate (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(), &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// Create the Krylov subspace &amp; preconditioner contexts</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      ierr = SLESGetKSP       (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      ierr = SLESGetPC        (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// Set user-specified  solver and preconditioner types</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">set_petsc_solver_type</a>();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// Set the options from user-input</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// Set runtime options, e.g.,</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">//      -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="comment">//  These options will override those specified above as long as</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="comment">//  SLESSetFromOptions() is called _after_ any other customization</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">//  routines.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      ierr = SLESSetFromOptions (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="comment">// 2.2.0 &amp; newer style</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="comment">// Create the linear solver context</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      ierr = KSPCreate (this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(), &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;          ierr = KSPSetOptionsPrefix(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, <a class="code" href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">name</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="comment">//ierr = PCCreate (this-&gt;comm().get(), &amp;_pc);</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">//     LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="comment">// Create the preconditioner context</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      ierr = KSPGetPC        (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), matrix-&gt;mat(),DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), matrix-&gt;mat());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">// Set user-specified  solver and preconditioner types</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">set_petsc_solver_type</a>();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// If the SolverConfiguration object is provided, use it to set</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// options during solver initialization.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>-&gt;<a class="code" href="classlibMesh_1_1SolverConfiguration.html#a9162128478dce78d7d8befc22b326225">set_options_during_init</a>();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">// Set the options from user-input</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">// Set runtime options, e.g.,</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">//      -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">//  These options will override those specified above as long as</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">//  KSPSetFromOptions() is called _after_ any other customization</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="comment">//  routines.</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      ierr = KSPSetFromOptions (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="comment">// Not sure if this is necessary, or if it is already handled by KSPSetFromOptions?</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// NOT NECESSARY!!!!</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">//ierr = PCSetFromOptions (_pc);</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="comment">//LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="comment">// Have the Krylov subspace method use our good initial guess</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">// rather than 0, unless the user requested a KSPType of</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">// preonly, which complains if asked to use initial guesses.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,0,0) || !PETSC_RELEASE_LESS_THAN(3,4,0)</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      KSPType ksp_type;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keyword">const</span> KSPType ksp_type;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      ierr = KSPGetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;ksp_type);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">if</span> (strcmp(ksp_type, <span class="stringliteral">&quot;preonly&quot;</span>))</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          ierr = KSPSetInitialGuessNonzero (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, PETSC_TRUE);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="comment">// Notify PETSc of location to store residual history.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// This needs to be called before any solves, since</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// it sets the residual history length to zero.  The default</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// behavior is for PETSc to allocate (internally) an array</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">// of size 1000 to hold the residual norm history.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      ierr = KSPSetResidualHistory(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                   PETSC_NULL,   <span class="comment">// pointer to the array which holds the history</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                   PETSC_DECIDE, <span class="comment">// size of the array holding the history</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                   PETSC_TRUE);  <span class="comment">// Whether or not to reset the history for each solve.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="classlibMesh_1_1PetscPreconditioner.html#aab69801de7b38fc74cf110baa0bcde9b">PetscPreconditioner&lt;T&gt;::set_petsc_preconditioner_type</a>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(*matrix);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          PCShellSetContext(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,(<span class="keywordtype">void</span>*)this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          PCShellSetSetUp(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,<a class="code" href="namespacelibMesh.html#a0ad4171647357ca5a2ffacb1c8ca5c6a">__libmesh_petsc_preconditioner_setup</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          PCShellSetApply(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>,<a class="code" href="namespacelibMesh.html#ae6c236ad49e5a5d8ad7f42d3f16b553e">__libmesh_petsc_preconditioner_apply</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Quality_html_a1d3617b89c15ade245910fc9a4ddfa34"><div class="ttname"><a href="namespacelibMesh_1_1Quality.html#a1d3617b89c15ade245910fc9a4ddfa34">libMesh::Quality::name</a></div><div class="ttdeci">std::string name(const ElemQuality q)</div><div class="ttdef"><b>Definition:</b> <a href="elem__quality_8C_source.html#l00039">elem_quality.C:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_ac9d7de69910e031898f5786b61816f72"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#ac9d7de69910e031898f5786b61816f72">libMesh::LinearSolver::initialized</a></div><div class="ttdeci">bool initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00086">linear_solver.h:86</a></div></div>
<div class="ttc" id="classlibMesh_1_1SolverConfiguration_html_a9162128478dce78d7d8befc22b326225"><div class="ttname"><a href="classlibMesh_1_1SolverConfiguration.html#a9162128478dce78d7d8befc22b326225">libMesh::SolverConfiguration::set_options_during_init</a></div><div class="ttdeci">virtual void set_options_during_init()</div><div class="ttdef"><b>Definition:</b> <a href="solver__configuration_8h_source.html#l00058">solver_configuration.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a5e0e279c8b33fdebb77bb1866667c69e"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">libMesh::PetscLinearSolver::_sles</a></div><div class="ttdeci">SLES _sles</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00284">petsc_linear_solver.h:284</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_aa8d4f205b150f8ca380e3338af168237"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">libMesh::LinearSolver::_solver_configuration</a></div><div class="ttdeci">SolverConfiguration * _solver_configuration</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00293">linear_solver.h:293</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a7ba2130af69add0da3a7526c79095090"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a7ba2130af69add0da3a7526c79095090">libMesh::PetscLinearSolver::set_petsc_solver_type</a></div><div class="ttdeci">void set_petsc_solver_type()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01837">petsc_linear_solver.C:1837</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aec0962b22c0c4b93c85a0eb73f356d08"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">libMesh::PetscLinearSolver::_pc</a></div><div class="ttdeci">PC _pc</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00291">petsc_linear_solver.h:291</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0ad4171647357ca5a2ffacb1c8ca5c6a"><div class="ttname"><a href="namespacelibMesh.html#a0ad4171647357ca5a2ffacb1c8ca5c6a">libMesh::__libmesh_petsc_preconditioner_setup</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_setup(void *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00051">petsc_linear_solver.C:51</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscPreconditioner_html_aab69801de7b38fc74cf110baa0bcde9b"><div class="ttname"><a href="classlibMesh_1_1PetscPreconditioner.html#aab69801de7b38fc74cf110baa0bcde9b">libMesh::PetscPreconditioner::set_petsc_preconditioner_type</a></div><div class="ttdeci">static void set_petsc_preconditioner_type(const PreconditionerType &amp;preconditioner_type, PC &amp;pc)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00118">petsc_preconditioner.C:118</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae6c236ad49e5a5d8ad7f42d3f16b553e"><div class="ttname"><a href="namespacelibMesh.html#ae6c236ad49e5a5d8ad7f42d3f16b553e">libMesh::__libmesh_petsc_preconditioner_apply</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_apply(void *ctx, Vec x, Vec y)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00064">petsc_linear_solver.C:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a97da17452484aa8121282f15248b8b9a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">libMesh::LinearSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00274">linear_solver.h:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a868f444745f8433c086ca14c69de9a6b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::init_names </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>sys</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply names to the system to be solved. This sets an option prefix from the system name and sets field names from the system's variable names.</p>
<p>Since field names are applied to DoF numberings, this method must be called again after any <a class="el" href="classlibMesh_1_1System.html">System</a> reinit. </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1LinearSolver.html#a6ac0c344d88df40035e3aa17269125d2">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00425">425</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__diff__solver_8C_source.html#l00143">libMesh::pc</a>, and <a class="el" href="petsc__auto__fieldsplit_8C_source.html#l00060">libMesh::petsc_auto_fieldsplit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <a class="code" href="namespacelibMesh.html#ace4baf57475ed3da562ba1ee3cd175c0">petsc_auto_fieldsplit</a>(this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a1aae14fe9e4e8e350918d1f954fd0444">pc</a>(), <a class="code" href="namespacelibMesh.html#a1345433246a95afac02ca599bda7a45b">sys</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ace4baf57475ed3da562ba1ee3cd175c0"><div class="ttname"><a href="namespacelibMesh.html#ace4baf57475ed3da562ba1ee3cd175c0">libMesh::petsc_auto_fieldsplit</a></div><div class="ttdeci">void petsc_auto_fieldsplit(PC my_pc, const System &amp;sys)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__auto__fieldsplit_8C_source.html#l00060">petsc_auto_fieldsplit.C:60</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a1345433246a95afac02ca599bda7a45b"><div class="ttname"><a href="namespacelibMesh.html#a1345433246a95afac02ca599bda7a45b">libMesh::sys</a></div><div class="ttdeci">ImplicitSystem &amp; sys</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00154">petsc_diff_solver.C:154</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a1aae14fe9e4e8e350918d1f954fd0444"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a1aae14fe9e4e8e350918d1f954fd0444">libMesh::PetscLinearSolver::pc</a></div><div class="ttdeci">PC pc()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00227">petsc_linear_solver.h:227</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9d7de69910e031898f5786b61816f72"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::initialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the data structures are initialized, false otherwise. </dd></dl>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00086">86</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">_is_initialized</a>; }</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a97da17452484aa8121282f15248b8b9a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a97da17452484aa8121282f15248b8b9a">libMesh::LinearSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00274">linear_solver.h:274</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f722acb8c35301ed1581726d4024d60"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::ksp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the raw PETSc ksp context pointer. This is useful if you are for example setting a custom convergence test with KSPSetConvergenceTest(). </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00234">234</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>References <a class="el" href="petsc__linear__solver_8h_source.html#l00296">libMesh::PetscLinearSolver&lt; T &gt;::_ksp</a>, and <a class="el" href="petsc__linear__solver_8C_source.html#l00163">libMesh::PetscLinearSolver&lt; T &gt;::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{ this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a>(); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>; }</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50e74641afc6e2870c9e1ce412f8c44f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int libMesh::ReferenceCounter::n_objects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the number of outstanding (created, but not yet destroyed) objects. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00075">75</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00122">libMesh::ReferenceCounter::_n_objects</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a>; }</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_ad2c30f0f71dcd00f00faa8e46aa3e043"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">libMesh::ReferenceCounter::_n_objects</a></div><div class="ttdeci">static Threads::atomic&lt; unsigned int &gt; _n_objects</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00122">reference_counter.h:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50719f74165b613ab929afd29b6d5f4a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::n_processors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the number of processors in the group. </dd></dl>

<p>Definition at line <a class="el" href="parallel__object_8h_source.html#l00093">93</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00105">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="parallel_8h_source.html#l00699">libMesh::Parallel::Communicator::size()</a>.</p>

<p>Referenced by <a class="el" href="parmetis__partitioner_8C_source.html#l00091">libMesh::ParmetisPartitioner::_do_repartition()</a>, <a class="el" href="boundary__info_8C_source.html#l01736">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00359">libMesh::ParallelMesh::add_elem()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00533">libMesh::ParallelMesh::add_node()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00298">libMesh::LaplaceMeshSmoother::allgather_graph()</a>, <a class="el" href="fem__system_8C_source.html#l00844">libMesh::FEMSystem::assembly()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00635">libMesh::ParmetisPartitioner::assign_partitioning()</a>, <a class="el" href="parallel__mesh_8C_source.html#l01363">libMesh::ParallelMesh::assign_unique_ids()</a>, <a class="el" href="trilinos__aztec__linear__solver_8h_source.html#l00168">libMesh::AztecLinearSolver&lt; T &gt;::AztecLinearSolver()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00694">libMesh::ParallelMesh::clear()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01878">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02473">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00640">libMesh::UnstructuredMesh::create_pid_mesh()</a>, <a class="el" href="dof__map_8C_source.html#l00845">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01100">libMesh::DofMap::distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01255">libMesh::DofMap::distribute_local_dofs_var_major()</a>, <a class="el" href="ensight__io_8C_source.html#l00039">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__base_8C_source.html#l00322">libMesh::MeshBase::get_info()</a>, <a class="el" href="equation__systems_8C_source.html#l00094">libMesh::EquationSystems::init()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00118">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00205">libMesh::ParmetisPartitioner::initialize()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00746">libMesh::Nemesis_IO_Helper::initialize()</a>, <a class="el" href="mesh__tools_8C_source.html#l01279">libMesh::MeshTools::libmesh_assert_valid_dof_ids()</a>, <a class="el" href="mesh__tools_8C_source.html#l01547">libMesh::MeshTools::libmesh_assert_valid_neighbors()</a>, <a class="el" href="mesh__tools_8C_source.html#l01302">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01387">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Node &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01463">libMesh::MeshTools::libmesh_assert_valid_refinement_flags()</a>, <a class="el" href="dof__map_8C_source.html#l01011">libMesh::DofMap::local_variable_indices()</a>, <a class="el" href="mesh__base_8C_source.html#l00283">libMesh::MeshBase::n_active_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00270">libMesh::MeshBase::n_elem_on_proc()</a>, <a class="el" href="mesh__base_8C_source.html#l00257">libMesh::MeshBase::n_nodes_on_proc()</a>, <a class="el" href="partitioner_8C_source.html#l00048">libMesh::Partitioner::partition()</a>, <a class="el" href="mesh__base_8h_source.html#l00534">libMesh::MeshBase::partition()</a>, <a class="el" href="partitioner_8C_source.html#l00180">libMesh::Partitioner::partition_unpartitioned_elements()</a>, <a class="el" href="petsc__linear__solver_8h_source.html#l00335">libMesh::PetscLinearSolver&lt; T &gt;::PetscLinearSolver()</a>, <a class="el" href="system_8C_source.html#l02097">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02202">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01994">libMesh::System::point_value()</a>, <a class="el" href="mesh__tools_8C_source.html#l00456">libMesh::MeshTools::processor_bounding_box()</a>, <a class="el" href="system__projection_8C_source.html#l00511">libMesh::System::project_vector()</a>, <a class="el" href="namebased__io_8C_source.html#l00064">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00136">libMesh::Nemesis_IO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00402">libMesh::CheckpointIO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01041">libMesh::XdrIO::read()</a>, <a class="el" href="system__io_8C_source.html#l00498">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01099">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="system__io_8C_source.html#l00784">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="system__io_8C_source.html#l01147">libMesh::System::read_serialized_vector()</a>, <a class="el" href="partitioner_8C_source.html#l00115">libMesh::Partitioner::repartition()</a>, <a class="el" href="partitioner_8C_source.html#l00439">libMesh::Partitioner::set_node_processor_ids()</a>, <a class="el" href="dof__map_8C_source.html#l00289">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00133">libMesh::ParallelMesh::update_parallel_id_counts()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00077">libMesh::CheckpointIO::write()</a>, <a class="el" href="gmv__io_8C_source.html#l01170">libMesh::GMVIO::write_binary()</a>, <a class="el" href="gmv__io_8C_source.html#l01583">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="system__io_8C_source.html#l01484">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02100">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l00831">libMesh::XdrIO::write_serialized_bcs()</a>, <a class="el" href="system__io_8C_source.html#l01806">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00344">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="xdr__io_8C_source.html#l00672">libMesh::XdrIO::write_serialized_nodes()</a>, and <a class="el" href="xdr__io_8C_source.html#l00919">libMesh::XdrIO::write_serialized_nodesets()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>()); }</div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00699">parallel.h:699</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00105">parallel_object.h:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1aae14fe9e4e8e350918d1f954fd0444"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PC <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::pc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the raw PETSc preconditioner context pointer. This allows you to specify the PCShellSetApply() and PCShellSetSetUp() functions if you desire. Just don't do anything crazy like calling PCDestroy()! </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00227">227</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>References <a class="el" href="petsc__linear__solver_8h_source.html#l00291">libMesh::PetscLinearSolver&lt; T &gt;::_pc</a>, and <a class="el" href="petsc__linear__solver_8C_source.html#l00163">libMesh::PetscLinearSolver&lt; T &gt;::init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{ this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a>(); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">_pc</a>; }</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aec0962b22c0c4b93c85a0eb73f356d08"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aec0962b22c0c4b93c85a0eb73f356d08">libMesh::PetscLinearSolver::_pc</a></div><div class="ttdeci">PC _pc</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00291">petsc_linear_solver.h:291</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32740239cc7991d77b4166331514f2ad"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a> <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::preconditioner_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the type of preconditioner to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00082">82</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;type();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79ad8a8998d0ccccf087c02a6d8292a0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::print_converged_reason </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints a useful message about why the latest linear solve con(di)verged. </p>

<p>Reimplemented in <a class="el" href="classlibMesh_1_1LaspackLinearSolver.html#a5df630b44995518d55745d4b14c5b1d3">libMesh::LaspackLinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00160">160</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>

<p>References <a class="el" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string()</a>, and <a class="el" href="libmesh__common_8h_source.html#l00231">libMesh::out</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38db">LinearConvergenceReason</a> reason = this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a580c58934e693b85caff32c27d602045">get_converged_reason</a>();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;Linear solver convergence/divergence reason: &quot;</span> &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(reason) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Utility_html_aa99a42a5efab878469e7f58e5c033335"><div class="ttname"><a href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string</a></div><div class="ttdeci">std::string enum_to_string(const T e)</div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a580c58934e693b85caff32c27d602045"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a580c58934e693b85caff32c27d602045">libMesh::LinearSolver::get_converged_reason</a></div><div class="ttdeci">virtual LinearConvergenceReason get_converged_reason() const =0</div></div>
<div class="ttc" id="namespacelibMesh_html_acea1691713bb6a88bb2befff232f38db"><div class="ttname"><a href="namespacelibMesh.html#acea1691713bb6a88bb2befff232f38db">libMesh::LinearConvergenceReason</a></div><div class="ttdeci">LinearConvergenceReason</div><div class="ttdef"><b>Definition:</b> <a href="enum__convergence__flags_8h_source.html#l00030">enum_convergence_flags.h:30</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a63e3c3158308e2184c12b55ab9ea9a35"><div class="ttname"><a href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></div><div class="ttdeci">OStreamProxy out(std::cout)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00231">libmesh_common.h:231</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f46edb253f11a90bfc5f824b45ed596"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::print_info </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em> = <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the reference information, by default to <code><a class="el" href="namespacelibMesh.html#a63e3c3158308e2184c12b55ab9ea9a35">libMesh::out</a></code>. </p>

<p>Definition at line <a class="el" href="reference__counter_8C_source.html#l00088">88</a> of file <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a>.</p>

<p>References <a class="el" href="reference__counter_8h_source.html#l00133">libMesh::ReferenceCounter::_enable_print_counter</a>, and <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> ) out_stream &lt;&lt; <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">ReferenceCounter::get_info</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a103b37125ae9eaaadf6f7854df17faa2"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">libMesh::ReferenceCounter::get_info</a></div><div class="ttdeci">static std::string get_info()</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8C_source.html#l00047">reference_counter.C:47</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00133">reference_counter.h:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1e7d1a1118f63d9889a761c27433bbc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#afebcb3616f8c81cda531dec404f2420d">processor_id_type</a> libMesh::ParallelObject::processor_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the rank of this processor in the group. </dd></dl>

<p>Definition at line <a class="el" href="parallel__object_8h_source.html#l00099">99</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p>References <a class="el" href="parallel__object_8h_source.html#l00105">libMesh::ParallelObject::_communicator</a>, and <a class="el" href="parallel_8h_source.html#l00697">libMesh::Parallel::Communicator::rank()</a>.</p>

<p>Referenced by <a class="el" href="metis__partitioner_8C_source.html#l00062">libMesh::MetisPartitioner::_do_partition()</a>, <a class="el" href="boundary__info_8C_source.html#l01736">libMesh::BoundaryInfo::_find_id_maps()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00154">libMesh::EquationSystems::_read_impl()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00359">libMesh::ParallelMesh::add_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l00318">libMesh::BoundaryInfo::add_elements()</a>, <a class="el" href="dof__map_8C_source.html#l01402">libMesh::DofMap::add_neighbors_to_send_list()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00533">libMesh::ParallelMesh::add_node()</a>, <a class="el" href="mesh__modification_8C_source.html#l00426">libMesh::UnstructuredMesh::all_second_order()</a>, <a class="el" href="fem__system_8C_source.html#l00844">libMesh::FEMSystem::assembly()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00635">libMesh::ParmetisPartitioner::assign_partitioning()</a>, <a class="el" href="parallel__mesh_8C_source.html#l01363">libMesh::ParallelMesh::assign_unique_ids()</a>, <a class="el" href="equation__systems_8C_source.html#l01017">libMesh::EquationSystems::build_discontinuous_solution_vector()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01706">libMesh::Nemesis_IO_Helper::build_element_and_node_maps()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00413">libMesh::ParmetisPartitioner::build_graph()</a>, <a class="el" href="inf__elem__builder_8C_source.html#l00044">libMesh::InfElemBuilder::build_inf_elem()</a>, <a class="el" href="dof__map_8C_source.html#l00055">libMesh::DofMap::build_sparsity()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00694">libMesh::ParallelMesh::clear()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00779">libMesh::ExodusII_IO_Helper::close()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01878">libMesh::Nemesis_IO_Helper::compute_border_node_ids()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01134">libMesh::Nemesis_IO_Helper::compute_communication_map_parameters()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01210">libMesh::Nemesis_IO_Helper::compute_internal_and_border_elems_and_internal_nodes()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01065">libMesh::Nemesis_IO_Helper::compute_node_communication_maps()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01596">libMesh::Nemesis_IO_Helper::compute_num_global_elem_blocks()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01473">libMesh::Nemesis_IO_Helper::compute_num_global_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l01364">libMesh::Nemesis_IO_Helper::compute_num_global_sidesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02473">libMesh::Nemesis_IO_Helper::construct_nemesis_filename()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01063">libMesh::ExodusII_IO_Helper::create()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00466">libMesh::ParallelMesh::delete_elem()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00630">libMesh::ParallelMesh::delete_node()</a>, <a class="el" href="dof__map_8C_source.html#l00845">libMesh::DofMap::distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01100">libMesh::DofMap::distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01255">libMesh::DofMap::distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8h_source.html#l00489">libMesh::DofMap::end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00501">libMesh::DofMap::end_old_dof()</a>, <a class="el" href="ensight__io_8C_source.html#l00039">libMesh::EnsightIO::EnsightIO()</a>, <a class="el" href="mesh__function_8C_source.html#l00441">libMesh::MeshFunction::find_element()</a>, <a class="el" href="unstructured__mesh_8C_source.html#l00221">libMesh::UnstructuredMesh::find_neighbors()</a>, <a class="el" href="dof__map_8h_source.html#l00452">libMesh::DofMap::first_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00462">libMesh::DofMap::first_old_dof()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00318">libMesh::Nemesis_IO_Helper::get_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00170">libMesh::Nemesis_IO_Helper::get_eb_info_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00398">libMesh::Nemesis_IO_Helper::get_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00245">libMesh::Nemesis_IO_Helper::get_elem_map()</a>, <a class="el" href="mesh__base_8C_source.html#l00322">libMesh::MeshBase::get_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00079">libMesh::Nemesis_IO_Helper::get_init_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00196">libMesh::Nemesis_IO_Helper::get_init_info()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00215">libMesh::Nemesis_IO_Helper::get_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00361">libMesh::Nemesis_IO_Helper::get_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00281">libMesh::Nemesis_IO_Helper::get_node_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00138">libMesh::Nemesis_IO_Helper::get_ns_param_global()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00102">libMesh::Nemesis_IO_Helper::get_ss_param_global()</a>, <a class="el" href="system__subset__by__subdomain_8C_source.html#l00118">libMesh::SystemSubsetBySubdomain::init()</a>, <a class="el" href="parmetis__partitioner_8C_source.html#l00205">libMesh::ParmetisPartitioner::initialize()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01103">libMesh::ExodusII_IO_Helper::initialize()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01550">libMesh::ExodusII_IO_Helper::initialize_element_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01625">libMesh::ExodusII_IO_Helper::initialize_global_variables()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01597">libMesh::ExodusII_IO_Helper::initialize_nodal_variables()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00448">libMesh::ParallelMesh::insert_elem()</a>, <a class="el" href="dof__map_8C_source.html#l02845">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="dof__map_8h_source.html#l00478">libMesh::DofMap::last_dof()</a>, <a class="el" href="mesh__tools_8C_source.html#l01302">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Elem &gt;()</a>, <a class="el" href="mesh__tools_8C_source.html#l01387">libMesh::MeshTools::libmesh_assert_valid_procids&lt; Node &gt;()</a>, <a class="el" href="dof__map_8C_source.html#l01011">libMesh::DofMap::local_variable_indices()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00859">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__base_8h_source.html#l00310">libMesh::MeshBase::n_active_local_elem()</a>, <a class="el" href="boundary__info_8C_source.html#l01299">libMesh::BoundaryInfo::n_boundary_conds()</a>, <a class="el" href="boundary__info_8C_source.html#l01321">libMesh::BoundaryInfo::n_edge_conds()</a>, <a class="el" href="dof__map_8h_source.html#l00435">libMesh::DofMap::n_local_dofs()</a>, <a class="el" href="system_8C_source.html#l00180">libMesh::System::n_local_dofs()</a>, <a class="el" href="mesh__base_8h_source.html#l00293">libMesh::MeshBase::n_local_elem()</a>, <a class="el" href="mesh__base_8h_source.html#l00207">libMesh::MeshBase::n_local_nodes()</a>, <a class="el" href="boundary__info_8C_source.html#l01344">libMesh::BoundaryInfo::n_nodeset_conds()</a>, <a class="el" href="weighted__patch__recovery__estimator_8C_source.html#l00103">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="dof__map_8C_source.html#l02452">libMesh::SparsityPattern::Build::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00190">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00034">libMesh::ParallelMesh::ParallelMesh()</a>, <a class="el" href="system_8C_source.html#l02097">libMesh::System::point_gradient()</a>, <a class="el" href="system_8C_source.html#l02202">libMesh::System::point_hessian()</a>, <a class="el" href="system_8C_source.html#l01994">libMesh::System::point_value()</a>, <a class="el" href="system__projection_8C_source.html#l00511">libMesh::System::project_vector()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00562">libMesh::Nemesis_IO_Helper::put_cmap_params()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00645">libMesh::Nemesis_IO_Helper::put_elem_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00666">libMesh::Nemesis_IO_Helper::put_elem_map()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00536">libMesh::Nemesis_IO_Helper::put_loadbal_param()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00586">libMesh::Nemesis_IO_Helper::put_node_cmap()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l00628">libMesh::Nemesis_IO_Helper::put_node_map()</a>, <a class="el" href="namebased__io_8C_source.html#l00064">libMesh::NameBasedIO::read()</a>, <a class="el" href="nemesis__io_8C_source.html#l00136">libMesh::Nemesis_IO::read()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00402">libMesh::CheckpointIO::read()</a>, <a class="el" href="xdr__io_8C_source.html#l01041">libMesh::XdrIO::read()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00623">libMesh::ExodusII_IO_Helper::read_elem_num_map()</a>, <a class="el" href="system__io_8C_source.html#l00115">libMesh::System::read_header()</a>, <a class="el" href="system__io_8C_source.html#l00310">libMesh::System::read_legacy_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l00473">libMesh::ExodusII_IO_Helper::read_node_num_map()</a>, <a class="el" href="system__io_8C_source.html#l00498">libMesh::System::read_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l01099">libMesh::System::read_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l01632">libMesh::XdrIO::read_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l01478">libMesh::XdrIO::read_serialized_bcs()</a>, <a class="el" href="system__io_8C_source.html#l00784">libMesh::System::read_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l01222">libMesh::XdrIO::read_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l00713">libMesh::System::read_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l01402">libMesh::XdrIO::read_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l01556">libMesh::XdrIO::read_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l01176">libMesh::XdrIO::read_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l01147">libMesh::System::read_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02201">libMesh::System::read_serialized_vectors()</a>, <a class="el" href="mesh__data__xdr__support_8C_source.html#l00035">libMesh::MeshData::read_xdr()</a>, <a class="el" href="partitioner_8C_source.html#l00439">libMesh::Partitioner::set_node_processor_ids()</a>, <a class="el" href="dof__map_8C_source.html#l00289">libMesh::DofMap::set_nonlocal_dof_objects()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00045">libMesh::LaplaceMeshSmoother::smooth()</a>, <a class="el" href="mesh__tools_8C_source.html#l00315">libMesh::MeshTools::total_weight()</a>, <a class="el" href="parallel__node_8C_source.html#l00190">libMesh::Parallel::unpack()</a>, <a class="el" href="parallel__mesh_8C_source.html#l00133">libMesh::ParallelMesh::update_parallel_id_counts()</a>, <a class="el" href="mesh__tools_8h_source.html#l00132">libMesh::MeshTools::weight()</a>, <a class="el" href="namebased__io_8C_source.html#l00289">libMesh::NameBasedIO::write()</a>, <a class="el" href="exodusII__io_8C_source.html#l00763">libMesh::ExodusII_IO::write()</a>, <a class="el" href="checkpoint__io_8C_source.html#l00077">libMesh::CheckpointIO::write()</a>, <a class="el" href="xdr__io_8C_source.html#l00157">libMesh::XdrIO::write()</a>, <a class="el" href="equation__systems__io_8C_source.html#l00389">libMesh::EquationSystems::write()</a>, <a class="el" href="gmv__io_8C_source.html#l01583">libMesh::GMVIO::write_discontinuous_gmv()</a>, <a class="el" href="exodusII__io_8C_source.html#l00505">libMesh::ExodusII_IO::write_element_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01694">libMesh::ExodusII_IO_Helper::write_element_values()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01281">libMesh::ExodusII_IO_Helper::write_elements()</a>, <a class="el" href="exodusII__io_8C_source.html#l00694">libMesh::ExodusII_IO::write_global_data()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01830">libMesh::ExodusII_IO_Helper::write_global_values()</a>, <a class="el" href="system__io_8C_source.html#l01276">libMesh::System::write_header()</a>, <a class="el" href="exodusII__io_8C_source.html#l00681">libMesh::ExodusII_IO::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01791">libMesh::ExodusII_IO_Helper::write_information_records()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01174">libMesh::ExodusII_IO_Helper::write_nodal_coordinates()</a>, <a class="el" href="ucd__io_8C_source.html#l00329">libMesh::UCDIO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00600">libMesh::ExodusII_IO::write_nodal_data()</a>, <a class="el" href="exodusII__io_8C_source.html#l00803">libMesh::ExodusII_IO::write_nodal_data_discontinuous()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01769">libMesh::ExodusII_IO_Helper::write_nodal_values()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01502">libMesh::ExodusII_IO_Helper::write_nodesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02020">libMesh::Nemesis_IO_Helper::write_nodesets()</a>, <a class="el" href="system__io_8C_source.html#l01484">libMesh::System::write_parallel_data()</a>, <a class="el" href="system__io_8C_source.html#l02100">libMesh::System::write_SCALAR_dofs()</a>, <a class="el" href="xdr__io_8C_source.html#l01001">libMesh::XdrIO::write_serialized_bc_names()</a>, <a class="el" href="xdr__io_8C_source.html#l00831">libMesh::XdrIO::write_serialized_bcs()</a>, <a class="el" href="system__io_8C_source.html#l01806">libMesh::System::write_serialized_blocked_dof_objects()</a>, <a class="el" href="xdr__io_8C_source.html#l00344">libMesh::XdrIO::write_serialized_connectivity()</a>, <a class="el" href="system__io_8C_source.html#l01695">libMesh::System::write_serialized_data()</a>, <a class="el" href="xdr__io_8C_source.html#l00672">libMesh::XdrIO::write_serialized_nodes()</a>, <a class="el" href="xdr__io_8C_source.html#l00919">libMesh::XdrIO::write_serialized_nodesets()</a>, <a class="el" href="xdr__io_8C_source.html#l00306">libMesh::XdrIO::write_serialized_subdomain_names()</a>, <a class="el" href="system__io_8C_source.html#l02155">libMesh::System::write_serialized_vector()</a>, <a class="el" href="system__io_8C_source.html#l02295">libMesh::System::write_serialized_vectors()</a>, <a class="el" href="exodusII__io__helper_8C_source.html#l01430">libMesh::ExodusII_IO_Helper::write_sidesets()</a>, <a class="el" href="nemesis__io__helper_8C_source.html#l02159">libMesh::Nemesis_IO_Helper::write_sidesets()</a>, <a class="el" href="exodusII__io_8C_source.html#l00747">libMesh::ExodusII_IO::write_timestep()</a>, and <a class="el" href="exodusII__io__helper_8C_source.html#l01680">libMesh::ExodusII_IO_Helper::write_timestep()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(<a class="code" href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">_communicator</a>.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">rank</a>()); }</div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a1ffb5b08919ab435109a302f94a7b3eb"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a1ffb5b08919ab435109a302f94a7b3eb">libMesh::ParallelObject::_communicator</a></div><div class="ttdeci">const Parallel::Communicator &amp; _communicator</div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00105">parallel_object.h:105</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a73e079f0714b243453b9c65d15fafd36"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a73e079f0714b243453b9c65d15fafd36">libMesh::Parallel::Communicator::rank</a></div><div class="ttdeci">unsigned int rank() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00697">parallel.h:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9462170c47c7d424153cdb578e5a38db"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::restrict_solve_to </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; *const&#160;</td>
          <td class="paramname"><em>dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1">SubsetSolveMode</a>&#160;</td>
          <td class="paramname"><em>subset_solve_mode</em> = <code><a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>After calling this method, all successive solves will be restricted to the given set of dofs, which must contain local dofs on each processor only and not contain any duplicates. This mode can be disabled by calling this method with <code>dofs</code> being a <code>NULL</code> pointer. </p>

<p>Reimplemented from <a class="el" href="classlibMesh_1_1LinearSolver.html#a04858dd8634c68ff5d301495d750224e">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00434">434</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, and <a class="el" href="petsc__macro_8h_source.html#l00122">PETSC_OWN_POINTER</a>.</p>
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="comment">/* The preconditioner (in particular if a default preconditioner)</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">     will have to be reset.  We call this-&gt;clear() to do that.  This</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">     call will also remove and free any previous subset that may have</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">     been set before.  */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ad3284c33fc49f7f37f013f2be6826ca3">clear</a>();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a> = subset_solve_mode;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span>(dofs!=NULL)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a>* petsc_dofs = NULL;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      ierr = PetscMalloc(dofs-&gt;size()*<span class="keyword">sizeof</span>(<a class="code" href="namespacelibMesh.html#a7ad10af8599548704f3938639a33b5ca">PetscInt</a>), &amp;petsc_dofs);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i=0; i&lt;dofs-&gt;size(); i++)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;          petsc_dofs[i] = (*dofs)[i];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      ierr = ISCreateLibMesh(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),dofs-&gt;<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(),petsc_dofs,<a class="code" href="petsc__macro_8h.html#ae087df21a67db9c4b0334f765d1af3bca7c3700533291999bc8618cc62bcc8486">PETSC_OWN_POINTER</a>,&amp;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ad3284c33fc49f7f37f013f2be6826ca3"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ad3284c33fc49f7f37f013f2be6826ca3">libMesh::PetscLinearSolver::clear</a></div><div class="ttdeci">virtual void clear() libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00108">petsc_linear_solver.C:108</a></div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00699">parallel.h:699</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="petsc__macro_8h_html_ae087df21a67db9c4b0334f765d1af3bca7c3700533291999bc8618cc62bcc8486"><div class="ttname"><a href="petsc__macro_8h.html#ae087df21a67db9c4b0334f765d1af3bca7c3700533291999bc8618cc62bcc8486">PETSC_OWN_POINTER</a></div><div class="ttdef"><b>Definition:</b> <a href="petsc__macro_8h_source.html#l00122">petsc_macro.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7ad10af8599548704f3938639a33b5ca"><div class="ttname"><a href="namespacelibMesh.html#a7ad10af8599548704f3938639a33b5ca">libMesh::PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00045">petsc_diff_solver.C:45</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9afecdb20ca3b66e7a33b72ddcddee8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::reuse_preconditioner </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reuse_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the same_preconditioner flag, which indicates if we reuse the same preconditioner for subsequent solves. </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00113">113</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>

<p>Referenced by <a class="el" href="implicit__system_8C_source.html#l00296">libMesh::ImplicitSystem::disable_cache()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> = reuse_flag;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a851fb44823b601cd8502fd7688266c29"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">libMesh::LinearSolver::same_preconditioner</a></div><div class="ttdeci">bool same_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00287">linear_solver.h:287</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ba2130af69add0da3a7526c79095090"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::set_petsc_solver_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tells PETSC to use the user-specified solver stored in <code>_solver_type</code> </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01837">1837</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="enum__solver__type_8h_source.html#l00037">libMesh::BICG</a>, <a class="el" href="enum__solver__type_8h_source.html#l00038">libMesh::BICGSTAB</a>, <a class="el" href="enum__solver__type_8h_source.html#l00030">libMesh::CG</a>, <a class="el" href="enum__solver__type_8h_source.html#l00032">libMesh::CGS</a>, <a class="el" href="enum__solver__type_8h_source.html#l00047">libMesh::CHEBYSHEV</a>, <a class="el" href="enum__solver__type_8h_source.html#l00033">libMesh::CR</a>, <a class="el" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string()</a>, <a class="el" href="libmesh__common_8h_source.html#l00232">libMesh::err</a>, <a class="el" href="enum__solver__type_8h_source.html#l00040">libMesh::GMRES</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="enum__solver__type_8h_source.html#l00041">libMesh::LSQR</a>, <a class="el" href="enum__solver__type_8h_source.html#l00039">libMesh::MINRES</a>, <a class="el" href="enum__solver__type_8h_source.html#l00046">libMesh::RICHARDSON</a>, <a class="el" href="enum__solver__type_8h_source.html#l00035">libMesh::TCQMR</a>, and <a class="el" href="enum__solver__type_8h_source.html#l00036">libMesh::TFQMR</a>.</p>
<div class="fragment"><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;{</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a> = 0;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a>)</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aa0a2ec60c3355ac9e9c226a0a36e14a9">CG</a>:</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPCG));</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54afc490da56adee1a5ddcf3a97044cb60c">CR</a>:</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPCR));</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a142e9bcff21cf6c7b105b642edff9f8b">CGS</a>:</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPCGS));</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54ab9ead42c4b68004188a866b6078f5778">BICG</a>:</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPBICG));</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a5c7f5197ebdeab292bbb785dc51c1be9">TCQMR</a>:</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPTCQMR));</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a9d3005e4dd787b12ea1704ee13519dcc">TFQMR</a>:</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPTFQMR));</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a2ac85bb4e115e47aa8be35e9d105b41b">LSQR</a>:</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPLSQR));</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aa384f1bc9ca9460df4e83d31e6b21483">BICGSTAB</a>:</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPBCGS));</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54acd6ae796c3f711636e94d90c5ec806c7">MINRES</a>:</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPMINRES));</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7">GMRES</a>:</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPGMRES));</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a574c3579fc17d4a4cea6e9a3c4f8ae1d">RICHARDSON</a>:</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPRICHARDSON));</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aad8cce8cc0a11382c44f575c41d2ac16">CHEBYSHEV</a>:</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="preprocessor">#if defined(LIBMESH_HAVE_PETSC) &amp;&amp; PETSC_VERSION_LESS_THAN(3,3,0)</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPCHEBYCHEV));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      ierr = KSPSetType (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, const_cast&lt;KSPType&gt;(KSPCHEBYSHEV));</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;ERROR:  Unsupported PETSC Solver: &quot;</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                   &lt;&lt; <a class="code" href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">Utility::enum_to_string</a>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a>) &lt;&lt; std::endl</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;Continuing with PETSC defaults&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    }</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54afc490da56adee1a5ddcf3a97044cb60c"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54afc490da56adee1a5ddcf3a97044cb60c">libMesh::CR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00033">enum_solver_type.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a6b64a30f2023ff38c662536f79a4451a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">libMesh::LinearSolver::_solver_type</a></div><div class="ttdeci">SolverType _solver_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00264">linear_solver.h:264</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a84d63ec52f59c09b4e71398f6039ecb7">libMesh::GMRES</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00040">enum_solver_type.h:40</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a2ac85bb4e115e47aa8be35e9d105b41b"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a2ac85bb4e115e47aa8be35e9d105b41b">libMesh::LSQR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00041">enum_solver_type.h:41</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54aa384f1bc9ca9460df4e83d31e6b21483"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aa384f1bc9ca9460df4e83d31e6b21483">libMesh::BICGSTAB</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00038">enum_solver_type.h:38</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a142e9bcff21cf6c7b105b642edff9f8b"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a142e9bcff21cf6c7b105b642edff9f8b">libMesh::CGS</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00032">enum_solver_type.h:32</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54acd6ae796c3f711636e94d90c5ec806c7"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54acd6ae796c3f711636e94d90c5ec806c7">libMesh::MINRES</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00039">enum_solver_type.h:39</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54ab9ead42c4b68004188a866b6078f5778"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54ab9ead42c4b68004188a866b6078f5778">libMesh::BICG</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00037">enum_solver_type.h:37</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a74e5bc8a72d210b3d87b0221b1f69db1"><div class="ttname"><a href="namespacelibMesh.html#a74e5bc8a72d210b3d87b0221b1f69db1">libMesh::err</a></div><div class="ttdeci">OStreamProxy err(std::cerr)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00232">libmesh_common.h:232</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a574c3579fc17d4a4cea6e9a3c4f8ae1d"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a574c3579fc17d4a4cea6e9a3c4f8ae1d">libMesh::RICHARDSON</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00046">enum_solver_type.h:46</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Utility_html_aa99a42a5efab878469e7f58e5c033335"><div class="ttname"><a href="namespacelibMesh_1_1Utility.html#aa99a42a5efab878469e7f58e5c033335">libMesh::Utility::enum_to_string</a></div><div class="ttdeci">std::string enum_to_string(const T e)</div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54aad8cce8cc0a11382c44f575c41d2ac16"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aad8cce8cc0a11382c44f575c41d2ac16">libMesh::CHEBYSHEV</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00047">enum_solver_type.h:47</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54aa0a2ec60c3355ac9e9c226a0a36e14a9"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54aa0a2ec60c3355ac9e9c226a0a36e14a9">libMesh::CG</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00030">enum_solver_type.h:30</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a9d3005e4dd787b12ea1704ee13519dcc"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a9d3005e4dd787b12ea1704ee13519dcc">libMesh::TFQMR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00036">enum_solver_type.h:36</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a67ae2194c38234da18c4833b879e3a54a5c7f5197ebdeab292bbb785dc51c1be9"><div class="ttname"><a href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54a5c7f5197ebdeab292bbb785dc51c1be9">libMesh::TCQMR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__solver__type_8h_source.html#l00035">enum_solver_type.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9bacfd14b9ad9cc5a996125dace2a021"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::set_preconditioner_type </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a>&#160;</td>
          <td class="paramname"><em>pct</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the type of preconditioner to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00092">92</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_type(pct);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">_preconditioner_type</a> = pct;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a866f963e86c384dc28fb3dbec70c5b39"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a866f963e86c384dc28fb3dbec70c5b39">libMesh::LinearSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00269">linear_solver.h:269</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3e64b8e6d70f7f32e8f427d9bfe38a5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::set_solver_configuration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SolverConfiguration.html">SolverConfiguration</a> &amp;&#160;</td>
          <td class="paramname"><em>solver_configuration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the solver configuration object. </p>

<p>Definition at line <a class="el" href="linear__solver_8C_source.html#l00167">167</a> of file <a class="el" href="linear__solver_8C_source.html">linear_solver.C</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a> = &amp;solver_configuration;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_aa8d4f205b150f8ca380e3338af168237"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">libMesh::LinearSolver::_solver_configuration</a></div><div class="ttdeci">SolverConfiguration * _solver_configuration</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00293">linear_solver.h:293</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2a012e2e7a62aaaaaaa15ec0fdef891"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::set_solver_type </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a>&#160;</td>
          <td class="paramname"><em>st</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the type of solver to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00117">117</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  { <a class="code" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a> = st; }</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a6b64a30f2023ff38c662536f79a4451a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">libMesh::LinearSolver::_solver_type</a></div><div class="ttdeci">SolverType _solver_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00264">linear_solver.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad81a95a20d13d097e436674228f8ba3f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::pair&lt;unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&gt; <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Call the Petsc solver. It calls the method below, using the same matrix for the system and preconditioner matrices. </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00155">155</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ad81a95a20d13d097e436674228f8ba3f">solve</a>(matrix_in, matrix_in, solution_in, rhs_in, tol, m_its);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ad81a95a20d13d097e436674228f8ba3f"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ad81a95a20d13d097e436674228f8ba3f">libMesh::PetscLinearSolver::solve</a></div><div class="ttdeci">virtual std::pair&lt; unsigned int, Real &gt; solve(SparseMatrix&lt; T &gt; &amp;matrix_in, NumericVector&lt; T &gt; &amp;solution_in, NumericVector&lt; T &gt; &amp;rhs_in, const double tol, const unsigned int m_its) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00155">petsc_linear_solver.h:155</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c88eb33c8d78c15cf9ed4c1bf372336"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>preconditioner</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method allows you to call a linear solver while specifying the matrix to use as the (left) preconditioning matrix. Note that the linear solver will not compute a preconditioner in this case, and will instead premultiply by the matrix you provide.</p>
<p>In PETSc, this is accomplished by calling</p>
<p>PCSetType(_pc, PCMAT);</p>
<p>before invoking KSPSolve(). Note: this functionality is not implemented in the <a class="el" href="classlibMesh_1_1LinearSolver.html">LinearSolver</a> class since there is not a built-in analog to this method for LasPack &ndash; You could probably implement it by hand if you wanted. </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#acaea679996585e7fb4f7ea0e3619f74d">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l00467">467</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__matrix_8C_source.html#l00931">libMesh::PetscMatrix&lt; T &gt;::close()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="namespacelibMesh_1_1TriangleWrapper.html#ae06da07f4c64d00ebefa55ce7f5c5e6b">libMesh::TriangleWrapper::init()</a>, <a class="el" href="petsc__matrix_8C_source.html#l00130">libMesh::PetscMatrix&lt; T &gt;::init()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="petsc__matrix_8h_source.html#l00368">libMesh::PetscMatrix&lt; T &gt;::mat()</a>, <a class="el" href="petsc__macro_8h_source.html#l00097">PetscBool</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00034">libMesh::SUBSET_COPY_RHS</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00035">libMesh::SUBSET_DONT_TOUCH</a>, and <a class="el" href="enum__subset__solve__mode_8h_source.html#l00033">libMesh::SUBSET_ZERO</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;{</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  PetscMatrix&lt;T&gt;* matrix   = cast_ptr&lt;PetscMatrix&lt;T&gt;*&gt;(&amp;matrix_in);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  PetscMatrix&lt;T&gt;* precond  = cast_ptr&lt;PetscMatrix&lt;T&gt;*&gt;(&amp;precond_in);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  PetscVector&lt;T&gt;* solution = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;solution_in);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  PetscVector&lt;T&gt;* rhs      = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;rhs_in);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a> (matrix);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its=0, max_its = <span class="keyword">static_cast&lt;</span><a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a><span class="keyword">&gt;</span>(m_its);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  PetscReal final_resid=0.;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// Close the matrices and vectors in case this wasn&#39;t already done.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  matrix-&gt;close ();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  precond-&gt;close ();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  solution-&gt;close ();</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  rhs-&gt;close ();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">//   // If matrix != precond, then this means we have specified a</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">//   // special preconditioner, so reset preconditioner type to PCMAT.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">//   if (matrix != precond)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="comment">//     {</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">//       this-&gt;_preconditioner_type = USER_PRECOND;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">//       this-&gt;set_petsc_preconditioner_type ();</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">//     }</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// 2.1.x &amp; earlier style</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,2,0)</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      libmesh_not_implemented();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  ierr = SLESSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, matrix-&gt;mat(), precond-&gt;mat(),</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                          DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, tol, PETSC_DEFAULT,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                           PETSC_DEFAULT, max_its);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  ierr = SLESSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">_sles</a>, rhs-&gt;vec(), solution-&gt;vec(), &amp;its);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// 2.2.0</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">#elif PETSC_VERSION_LESS_THAN(2,2,1)</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      libmesh_not_implemented();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">//ierr = KSPSetOperators(_ksp, matrix-&gt;mat(), precond-&gt;mat(),</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// SAME_NONZERO_PATTERN);</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">//       LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="comment">// Convergence is detected at iteration k if</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// ||r_k||_2 &lt; max(rtol*||b||_2 , abstol)</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// where r_k is the residual vector and b is the right-hand side.  Note that</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// it is the *maximum* of the two values, the larger of which will almost</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// always be rtol*||b||_2.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                           tol,           <span class="comment">// rtol   = relative decrease in residual  (1.e-5)</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                           PETSC_DEFAULT, <span class="comment">// abstol = absolute convergence tolerance (1.e-50)</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                           PETSC_DEFAULT, <span class="comment">// dtol   = divergence tolerance           (1.e+5)</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                           max_its);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">// Set the solution vector to use</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  ierr = KSPSetSolution (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, solution-&gt;vec());</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">// Set the RHS vector to use</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  ierr = KSPSetRhs (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec());</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <span class="comment">// 2.2.1 &amp; newer style</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  Mat submat = NULL;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  Mat subprecond = NULL;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  Vec subrhs = NULL;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  Vec subsolution = NULL;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  VecScatter scatter = NULL;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  PetscMatrix&lt;Number&gt;* subprecond_matrix = NULL;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// Set operators.  Also restrict rhs and solution vector to</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// subdomain if neccessary.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_local_size = this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">_restrict_solve_to_is_local_size</a>();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subrhs);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      ierr = VecSetSizes(subrhs,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      ierr = VecSetFromOptions(subrhs);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subsolution);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      ierr = VecSetSizes(subsolution,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      ierr = VecSetFromOptions(subsolution);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>, subrhs,NULL, &amp;scatter);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      ierr = VecScatterBegin(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      ierr = VecScatterEnd(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      ierr = VecScatterBegin(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      ierr = VecScatterEnd(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                             PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      ierr = MatGetSubMatrix(precond-&gt;mat(),</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                             PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;subprecond);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                             MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      ierr = MatGetSubMatrix(precond-&gt;mat(),</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                             MAT_INITIAL_MATRIX,&amp;subprecond);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">/* Since removing columns of the matrix changes the equation</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">         system, we will now change the right hand side to compensate</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">         for this.  Note that this is not necessary if \p SUBSET_ZERO</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">         has been selected.  */</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>!=<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is</a>(rhs_in);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;          <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_complement_local_size =</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            cast_int&lt;PetscInt&gt;(rhs_in.local_size()-is_local_size);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          Vec subvec1 = NULL;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          Mat submat1 = NULL;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          VecScatter scatter1 = NULL;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec1);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          ierr = VecSetSizes(subvec1,is_complement_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          ierr = VecSetFromOptions(subvec1);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>, subvec1,NULL, &amp;scatter1);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          ierr = VecScatterBegin(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;          ierr = VecScatterEnd(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;          ierr = VecScale(subvec1,-1.0);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;          ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                 PETSC_DECIDE,MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;          ierr = MatGetSubMatrix(matrix-&gt;mat(),</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                 MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          ierr = MatMultAdd(submat1,subvec1,subrhs,subrhs);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          ierr = LibMeshVecScatterDestroy(&amp;scatter1);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          ierr = LibMeshVecDestroy(&amp;subvec1);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          ierr = LibMeshMatDestroy(&amp;submat1);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                             this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <a class="code" href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a> ksp_reuse_preconditioner = this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? PETSC_TRUE : PETSC_FALSE;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      ierr = KSPSetReusePreconditioner(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, ksp_reuse_preconditioner);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          subprecond_matrix = <span class="keyword">new</span> PetscMatrix&lt;Number&gt;(subprecond,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                                      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(*subprecond_matrix);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), precond-&gt;mat(),</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                             this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? SAME_PRECONDITIONER : DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, matrix-&gt;mat(), precond-&gt;mat());</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a> ksp_reuse_preconditioner = this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">same_preconditioner</a> ? PETSC_TRUE : PETSC_FALSE;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      ierr = KSPSetReusePreconditioner(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, ksp_reuse_preconditioner);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(matrix_in);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, tol, PETSC_DEFAULT,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                           PETSC_DEFAULT, max_its);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">// If the SolverConfiguration object is provided, use it to override</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">// solver options.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">_solver_configuration</a>-&gt;<a class="code" href="classlibMesh_1_1SolverConfiguration.html#ac35f377561c3436662e0efb8d8f97137">configure_solver</a>();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span>(_restrict_solve_to_is!=NULL)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, subrhs, subsolution);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="keywordflow">if</span>(_restrict_solve_to_is!=NULL)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          ierr = VecZeroEntries(solution-&gt;vec());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a>:</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          ierr = VecCopy(rhs-&gt;vec(),solution-&gt;vec());</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">SUBSET_DONT_TOUCH</a>:</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;          <span class="comment">/* Nothing to do here.  */</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;          libmesh_error_msg(<span class="stringliteral">&quot;Invalid subset solve mode = &quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      ierr = VecScatterBegin(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      ierr = VecScatterEnd(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      ierr = LibMeshVecScatterDestroy(&amp;scatter);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;          <span class="comment">/* Before we delete subprecond_matrix, we should give the</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">             _preconditioner a different matrix.  */</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(matrix_in);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;          <span class="keyword">delete</span> subprecond_matrix;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;          subprecond_matrix = NULL;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      ierr = LibMeshVecDestroy(&amp;subsolution);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      ierr = LibMeshVecDestroy(&amp;subrhs);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      ierr = LibMeshMatDestroy(&amp;submat);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      ierr = LibMeshMatDestroy(&amp;subprecond);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// return the # of its. and the final residual norm.</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  <span class="keywordflow">return</span> std::make_pair(its, final_resid);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">libMesh::SUBSET_DONT_TOUCH</a></div><div class="ttdoc">Leaves dofs outside the subset unchanged. This is fastest, but also most confusing because it abandon...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00035">enum_subset_solve_mode.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">libMesh::SUBSET_ZERO</a></div><div class="ttdoc">Set dofs outside the subset to zero. </div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00033">enum_subset_solve_mode.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a53c040d15138a248ff0f1006aa42a23c"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">libMesh::PetscLinearSolver::_create_complement_is</a></div><div class="ttdeci">void _create_complement_is(const NumericVector&lt; T &gt; &amp;vec_in)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00376">petsc_linear_solver.h:376</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="classlibMesh_1_1SolverConfiguration_html_ac35f377561c3436662e0efb8d8f97137"><div class="ttname"><a href="classlibMesh_1_1SolverConfiguration.html#ac35f377561c3436662e0efb8d8f97137">libMesh::SolverConfiguration::configure_solver</a></div><div class="ttdeci">virtual void configure_solver()=0</div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a5e0e279c8b33fdebb77bb1866667c69e"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a5e0e279c8b33fdebb77bb1866667c69e">libMesh::PetscLinearSolver::_sles</a></div><div class="ttdeci">SLES _sles</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00284">petsc_linear_solver.h:284</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_aa8d4f205b150f8ca380e3338af168237"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#aa8d4f205b150f8ca380e3338af168237">libMesh::LinearSolver::_solver_configuration</a></div><div class="ttdeci">SolverConfiguration * _solver_configuration</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00293">linear_solver.h:293</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">libMesh::SUBSET_COPY_RHS</a></div><div class="ttdoc">Set dofs outside the subset to the value of the corresponding dofs of the right hand side...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00034">enum_subset_solve_mode.h:34</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a005e7b0e81dbc5d604296fa441692d30"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">libMesh::PetscLinearSolver::_restrict_solve_to_is_local_size</a></div><div class="ttdeci">PetscInt _restrict_solve_to_is_local_size(void) const </div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00361">petsc_linear_solver.h:361</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a851fb44823b601cd8502fd7688266c29"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a851fb44823b601cd8502fd7688266c29">libMesh::LinearSolver::same_preconditioner</a></div><div class="ttdeci">bool same_preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00287">linear_solver.h:287</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="petsc__macro_8h_html_a118393cd7c42d4cc73950defd0e32873"><div class="ttname"><a href="petsc__macro_8h.html#a118393cd7c42d4cc73950defd0e32873">PetscBool</a></div><div class="ttdeci">EXTERN_C_FOR_PETSC_BEGIN EXTERN_C_FOR_PETSC_END typedef PetscTruth PetscBool</div><div class="ttdef"><b>Definition:</b> <a href="petsc__macro_8h_source.html#l00097">petsc_macro.h:97</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af3da3257c681022416a6f20b94c60eed"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>precond_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n_iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function calls the solver "_solver_type" preconditioned with the "_preconditioner_type" preconditioner. The preconditioning matrix is used if it is provided, or the system matrix is used if <code>precond_matrix</code> is null </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00332">332</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;{</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">if</span> (pc_mat)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">solve</a>(mat, *pc_mat, sol, rhs, tol, n_iter);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">solve</a>(mat, sol, rhs, tol, n_iter);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a9663fee6659bd9705e72142d5e42a02a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">libMesh::LinearSolver::solve</a></div><div class="ttdeci">virtual std::pair&lt; unsigned int, Real &gt; solve(SparseMatrix&lt; T &gt; &amp;, NumericVector&lt; T &gt; &amp;, NumericVector&lt; T &gt; &amp;, const double, const unsigned int)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5670c09fd65a3edc711653734add41bd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>shell_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves a system whose matrix is a shell matrix. </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#a69a6827bcab11a5651a563013dcb054b">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01182">1182</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__vector_8h_source.html#l00936">libMesh::PetscVector&lt; T &gt;::close()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="namespacelibMesh_1_1TriangleWrapper.html#ae06da07f4c64d00ebefa55ce7f5c5e6b">libMesh::TriangleWrapper::init()</a>, <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00034">libMesh::SUBSET_COPY_RHS</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00035">libMesh::SUBSET_DONT_TOUCH</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00033">libMesh::SUBSET_ZERO</a>, and <a class="el" href="petsc__vector_8h_source.html#l00495">libMesh::PetscVector&lt; T &gt;::vec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,3,1)</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="comment">// FIXME[JWP]: There will be a bunch of unused variable warnings</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="comment">// for older PETScs here.</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  libmesh_error_msg(<span class="stringliteral">&quot;This method has been developed with PETSc 2.3.1.  &quot;</span> \</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;No one has made it backwards compatible with older &quot;</span> \</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;versions of PETSc so far; however, it might work &quot;</span> \</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;without any change with some older version.&quot;</span>);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;The current implementation of subset solves with &quot;</span> \</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;shell matrices requires PETSc version 3.1 or above.  &quot;</span> \</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Older PETSc version do not support automatic &quot;</span> \</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;submatrix generation of shell matrices.&quot;</span>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  PetscVector&lt;T&gt;* solution = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;solution_in);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  PetscVector&lt;T&gt;* rhs      = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;rhs_in);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a> ();</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its=0, max_its = <span class="keyword">static_cast&lt;</span><a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a><span class="keyword">&gt;</span>(m_its);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  PetscReal final_resid=0.;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  Mat submat = NULL;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  Vec subrhs = NULL;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  Vec subsolution = NULL;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  VecScatter scatter = NULL;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="comment">// Close the matrices and vectors in case this wasn&#39;t already done.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  solution-&gt;close ();</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  rhs-&gt;close ();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="comment">// Prepare the matrix.</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  Mat mat;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  ierr = MatCreateShell(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        rhs_in.local_size(),</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        solution_in.local_size(),</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                        rhs_in.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(),</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                        solution_in.size(),</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                        <span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(&amp;shell_matrix)),</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                        &amp;mat);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <span class="comment">/* Note that the const_cast above is only necessary because PETSc</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">     does not accept a const void*.  Inside the member function</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">     _petsc_shell_matrix() below, the pointer is casted back to a</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">     const ShellMatrix&lt;T&gt;*.  */</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_MULT,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a74fc6258796b7724355d07fac71e335b">_petsc_shell_matrix_mult</a>));</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_MULT_ADD,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aca0fc5357cfc5608df9c2ed47ae2c471">_petsc_shell_matrix_mult_add</a>));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_GET_DIAGONAL,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8568708754d996fda7f23f507577b4e9">_petsc_shell_matrix_get_diagonal</a>));</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="comment">// Restrict rhs and solution vectors and set operators.  The input</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// matrix works as the preconditioning matrix.</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_local_size = this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">_restrict_solve_to_is_local_size</a>();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subrhs);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      ierr = VecSetSizes(subrhs,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      ierr = VecSetFromOptions(subrhs);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subsolution);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      ierr = VecSetSizes(subsolution,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      ierr = VecSetFromOptions(subsolution);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>, subrhs,NULL, &amp;scatter);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      ierr = VecScatterBegin(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      ierr = VecScatterEnd(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      ierr = VecScatterBegin(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      ierr = VecScatterEnd(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="comment">/* This point can&#39;t be reached, see above.  */</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      ierr = MatGetSubMatrix(mat,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                             MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="comment">/* Since removing columns of the matrix changes the equation</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">         system, we will now change the right hand side to compensate</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">         for this.  Note that this is not necessary if \p SUBSET_ZERO</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">         has been selected.  */</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>!=<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is</a>(rhs_in);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_complement_local_size =</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            cast_int&lt;PetscInt&gt;(rhs_in.local_size()-is_local_size);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;          Vec subvec1 = NULL;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;          Mat submat1 = NULL;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;          VecScatter scatter1 = NULL;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec1);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          ierr = VecSetSizes(subvec1,is_complement_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;          ierr = VecSetFromOptions(subvec1);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>, subvec1,NULL, &amp;scatter1);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;          ierr = VecScatterBegin(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;          ierr = VecScatterEnd(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          ierr = VecScale(subvec1,-1.0);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;          <span class="comment">/* This point can&#39;t be reached, see above.  */</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;          ierr = MatGetSubMatrix(mat,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                 MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="comment">// The following lines would be correct, but don&#39;t work</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          <span class="comment">// correctly in PETSc up to 3.1.0-p5.  See discussion in</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          <span class="comment">// petsc-users of Nov 9, 2010.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          <span class="comment">// ierr = MatMultAdd(submat1,subvec1,subrhs,subrhs);</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          <span class="comment">// LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="comment">// We workaround by using a temporary vector.  Note that the</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          <span class="comment">// fix in PETsc 3.1.0-p6 uses a temporary vector internally,</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          <span class="comment">// so this is no effective performance loss.</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          Vec subvec2 = NULL;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec2);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          ierr = VecSetSizes(subvec2,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          ierr = VecSetFromOptions(subvec2);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          ierr = MatMult(submat1,subvec1,subvec2);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          ierr = VecAXPY(subrhs,1.0,subvec2);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          ierr = LibMeshVecScatterDestroy(&amp;scatter1);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          ierr = LibMeshVecDestroy(&amp;subvec1);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          ierr = LibMeshMatDestroy(&amp;submat1);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, submat,</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                             DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, submat);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, mat, mat,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                             DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, mat, mat);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, tol, PETSC_DEFAULT,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                           PETSC_DEFAULT, max_its);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, subrhs, subsolution);</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>:</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          ierr = VecZeroEntries(solution-&gt;vec());</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a>:</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          ierr = VecCopy(rhs-&gt;vec(),solution-&gt;vec());</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">SUBSET_DONT_TOUCH</a>:</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          <span class="comment">/* Nothing to do here.  */</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          libmesh_error_msg(<span class="stringliteral">&quot;Invalid subset solve mode = &quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      ierr = VecScatterBegin(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      ierr = VecScatterEnd(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      ierr = LibMeshVecScatterDestroy(&amp;scatter);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      ierr = LibMeshVecDestroy(&amp;subsolution);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      ierr = LibMeshVecDestroy(&amp;subrhs);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      ierr = LibMeshMatDestroy(&amp;submat);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="comment">// Destroy the matrix.</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  ierr = LibMeshMatDestroy(&amp;mat);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="comment">// return the # of its. and the final residual norm.</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordflow">return</span> std::make_pair(its, final_resid);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">libMesh::SUBSET_DONT_TOUCH</a></div><div class="ttdoc">Leaves dofs outside the subset unchanged. This is fastest, but also most confusing because it abandon...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00035">enum_subset_solve_mode.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00699">parallel.h:699</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">libMesh::SUBSET_ZERO</a></div><div class="ttdoc">Set dofs outside the subset to zero. </div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00033">enum_subset_solve_mode.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a53c040d15138a248ff0f1006aa42a23c"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">libMesh::PetscLinearSolver::_create_complement_is</a></div><div class="ttdeci">void _create_complement_is(const NumericVector&lt; T &gt; &amp;vec_in)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00376">petsc_linear_solver.h:376</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aca0fc5357cfc5608df9c2ed47ae2c471"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aca0fc5357cfc5608df9c2ed47ae2c471">libMesh::PetscLinearSolver::_petsc_shell_matrix_mult_add</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_mult_add(Mat mat, Vec arg, Vec add, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01985">petsc_linear_solver.C:1985</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">libMesh::SUBSET_COPY_RHS</a></div><div class="ttdoc">Set dofs outside the subset to the value of the corresponding dofs of the right hand side...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00034">enum_subset_solve_mode.h:34</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a74fc6258796b7724355d07fac71e335b"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a74fc6258796b7724355d07fac71e335b">libMesh::PetscLinearSolver::_petsc_shell_matrix_mult</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_mult(Mat mat, Vec arg, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01961">petsc_linear_solver.C:1961</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a005e7b0e81dbc5d604296fa441692d30"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">libMesh::PetscLinearSolver::_restrict_solve_to_is_local_size</a></div><div class="ttdeci">PetscInt _restrict_solve_to_is_local_size(void) const </div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00361">petsc_linear_solver.h:361</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8568708754d996fda7f23f507577b4e9"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8568708754d996fda7f23f507577b4e9">libMesh::PetscLinearSolver::_petsc_shell_matrix_get_diagonal</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_get_diagonal(Mat mat, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l02015">petsc_linear_solver.C:2015</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d0fbec932c6e0df11af0f85c7eaa212"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>shell_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>precond_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves a system whose matrix is a shell matrix, but a sparse matrix is used as preconditioning matrix, this allowing other preconditioners than JACOBI. </p>

<p>Implements <a class="el" href="classlibMesh_1_1LinearSolver.html#aec970c0706e6d0c941cff1c670ec01ee">libMesh::LinearSolver&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8C_source.html#l01461">1461</a> of file <a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a>.</p>

<p>References <a class="el" href="petsc__matrix_8C_source.html#l00931">libMesh::PetscMatrix&lt; T &gt;::close()</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00261">libMesh::comm</a>, <a class="el" href="petsc__preconditioner_8C_source.html#l00281">libMesh::ierr</a>, <a class="el" href="namespacelibMesh_1_1TriangleWrapper.html#ae06da07f4c64d00ebefa55ce7f5c5e6b">libMesh::TriangleWrapper::init()</a>, <a class="el" href="petsc__matrix_8C_source.html#l00130">libMesh::PetscMatrix&lt; T &gt;::init()</a>, <a class="el" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a>, <a class="el" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG()</a>, <a class="el" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG()</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00034">libMesh::SUBSET_COPY_RHS</a>, <a class="el" href="enum__subset__solve__mode_8h_source.html#l00035">libMesh::SUBSET_DONT_TOUCH</a>, and <a class="el" href="enum__subset__solve__mode_8h_source.html#l00033">libMesh::SUBSET_ZERO</a>.</p>
<div class="fragment"><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;{</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(2,3,1)</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="comment">// FIXME[JWP]: There will be a bunch of unused variable warnings</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">// for older PETScs here.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  libmesh_error_msg(<span class="stringliteral">&quot;This method has been developed with PETSc 2.3.1.  &quot;</span> \</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;No one has made it backwards compatible with older &quot;</span> \</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;versions of PETSc so far; however, it might work &quot;</span> \</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;without any change with some older version.&quot;</span>);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;The current implementation of subset solves with &quot;</span> \</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;shell matrices requires PETSc version 3.1 or above.  &quot;</span> \</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;Older PETSc version do not support automatic &quot;</span> \</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                      &lt;&lt; <span class="stringliteral">&quot;submatrix generation of shell matrices.&quot;</span>);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <a class="code" href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">START_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keyword">const</span> PetscMatrix&lt;T&gt;* precond  = cast_ptr&lt;const PetscMatrix&lt;T&gt;*&gt;(&amp;precond_matrix);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  PetscVector&lt;T&gt;* solution = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;solution_in);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  PetscVector&lt;T&gt;* rhs      = cast_ptr&lt;PetscVector&lt;T&gt;*&gt;(&amp;rhs_in);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">init</a> ();</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <a class="code" href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">PetscErrorCode</a> <a class="code" href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">ierr</a>=0;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> its=0, max_its = <span class="keyword">static_cast&lt;</span><a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a><span class="keyword">&gt;</span>(m_its);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  PetscReal final_resid=0.;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  Mat submat = NULL;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  Mat subprecond = NULL;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  Vec subrhs = NULL;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  Vec subsolution = NULL;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  VecScatter scatter = NULL;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  PetscMatrix&lt;Number&gt;* subprecond_matrix = NULL;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">// Close the matrices and vectors in case this wasn&#39;t already done.</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  solution-&gt;close ();</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  rhs-&gt;close ();</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">// Prepare the matrix.</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  Mat mat;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  ierr = MatCreateShell(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        rhs_in.local_size(),</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        solution_in.local_size(),</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                        rhs_in.<a class="code" href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">size</a>(),</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                        solution_in.size(),</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        <span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(&amp;shell_matrix)),</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        &amp;mat);</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="comment">/* Note that the const_cast above is only necessary because PETSc</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">     does not accept a const void*.  Inside the member function</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">     _petsc_shell_matrix() below, the pointer is casted back to a</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">     const ShellMatrix&lt;T&gt;*.  */</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_MULT,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a74fc6258796b7724355d07fac71e335b">_petsc_shell_matrix_mult</a>));</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_MULT_ADD,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aca0fc5357cfc5608df9c2ed47ae2c471">_petsc_shell_matrix_mult_add</a>));</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  ierr = MatShellSetOperation(mat,MATOP_GET_DIAGONAL,<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>)<span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8568708754d996fda7f23f507577b4e9">_petsc_shell_matrix_get_diagonal</a>));</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="comment">// Restrict rhs and solution vectors and set operators.  The input</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="comment">// matrix works as the preconditioning matrix.</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_local_size = this-&gt;<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">_restrict_solve_to_is_local_size</a>();</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subrhs);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      ierr = VecSetSizes(subrhs,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      ierr = VecSetFromOptions(subrhs);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subsolution);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      ierr = VecSetSizes(subsolution,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      ierr = VecSetFromOptions(subsolution);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>, subrhs,NULL, &amp;scatter);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      ierr = VecScatterBegin(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      ierr = VecScatterEnd(scatter,rhs-&gt;vec(),subrhs,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      ierr = VecScatterBegin(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      ierr = VecScatterEnd(scatter,solution-&gt;vec(),subsolution,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      <span class="comment">/* This point can&#39;t be reached, see above.  */</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      ierr = MatGetSubMatrix(mat,</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                             MAT_INITIAL_MATRIX,&amp;submat);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      ierr = MatGetSubMatrix(<span class="keyword">const_cast&lt;</span>PetscMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(precond)-&gt;mat(),</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                             <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                             MAT_INITIAL_MATRIX,&amp;subprecond);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="comment">/* Since removing columns of the matrix changes the equation</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment">         system, we will now change the right hand side to compensate</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">         for this.  Note that this is not necessary if \p SUBSET_ZERO</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment">         has been selected.  */</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>!=<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;          <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is</a>(rhs_in);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;          <a class="code" href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a> is_complement_local_size = rhs_in.local_size()-is_local_size;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;          Vec subvec1 = NULL;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;          Mat submat1 = NULL;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;          VecScatter scatter1 = NULL;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec1);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;          ierr = VecSetSizes(subvec1,is_complement_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;          ierr = VecSetFromOptions(subvec1);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          ierr = VecScatterCreate(rhs-&gt;vec(),<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>, subvec1,NULL, &amp;scatter1);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;          ierr = VecScatterBegin(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;          ierr = VecScatterEnd(scatter1,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>==<a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a> ? rhs-&gt;vec() : solution-&gt;vec(),subvec1,INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          ierr = VecScale(subvec1,-1.0);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,1,0)</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;          <span class="comment">/* This point can&#39;t be reached, see above.  */</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          <a class="code" href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libmesh_assert</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          ierr = MatGetSubMatrix(mat,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                                 <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>,<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">_restrict_solve_to_is_complement</a>,</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                                 MAT_INITIAL_MATRIX,&amp;submat1);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          <span class="comment">// The following lines would be correct, but don&#39;t work</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          <span class="comment">// correctly in PETSc up to 3.1.0-p5.  See discussion in</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          <span class="comment">// petsc-users of Nov 9, 2010.</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;          <span class="comment">// ierr = MatMultAdd(submat1,subvec1,subrhs,subrhs);</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          <span class="comment">// LIBMESH_CHKERR(ierr);</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;          <span class="comment">//</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;          <span class="comment">// We workaround by using a temporary vector.  Note that the</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;          <span class="comment">// fix in PETsc 3.1.0-p6 uses a temporary vector internally,</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;          <span class="comment">// so this is no effective performance loss.</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;          Vec subvec2 = NULL;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;          ierr = VecCreate(this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>().<span class="keyword">get</span>(),&amp;subvec2);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;          ierr = VecSetSizes(subvec2,is_local_size,PETSC_DECIDE);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          ierr = VecSetFromOptions(subvec2);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          ierr = MatMult(submat1,subvec1,subvec2);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          ierr = VecAXPY(subrhs,1.0,subvec2);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;          ierr = LibMeshVecScatterDestroy(&amp;scatter1);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;          ierr = LibMeshVecDestroy(&amp;subvec1);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          ierr = LibMeshMatDestroy(&amp;submat1);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        }</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond,</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                             DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, submat, subprecond);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;          subprecond_matrix = <span class="keyword">new</span> PetscMatrix&lt;Number&gt;(subprecond,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                                      this-&gt;<a class="code" href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">comm</a>());</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(*subprecond_matrix);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor">#if PETSC_RELEASE_LESS_THAN(3,5,0)</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, mat, <span class="keyword">const_cast&lt;</span>PetscMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(precond)-&gt;mat(),</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                             DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      ierr = KSPSetOperators(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, mat, <span class="keyword">const_cast&lt;</span>PetscMatrix&lt;T&gt;*<span class="keyword">&gt;</span>(precond)-&gt;mat());</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(<span class="keyword">const_cast&lt;</span>SparseMatrix&lt;Number&gt;&amp;<span class="keyword">&gt;</span>(precond_matrix));</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  ierr = KSPSetTolerances (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, tol, PETSC_DEFAULT,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                           PETSC_DEFAULT, max_its);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;  <span class="comment">// Solve the linear system</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, subrhs, subsolution);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      ierr = KSPSolve (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  ierr = KSPGetIterationNumber (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;its);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  ierr = KSPGetResidualNorm (<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">_ksp</a>, &amp;final_resid);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">_restrict_solve_to_is</a>!=NULL)</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">switch</span>(<a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>)</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">SUBSET_ZERO</a>:</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          ierr = VecZeroEntries(solution-&gt;vec());</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">SUBSET_COPY_RHS</a>:</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;          ierr = VecCopy(rhs-&gt;vec(),solution-&gt;vec());</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;          LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">SUBSET_DONT_TOUCH</a>:</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;          <span class="comment">/* Nothing to do here.  */</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;          libmesh_error_msg(<span class="stringliteral">&quot;Invalid subset solve mode = &quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">_subset_solve_mode</a>);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      ierr = VecScatterBegin(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      ierr = VecScatterEnd(scatter,subsolution,solution-&gt;vec(),INSERT_VALUES,SCATTER_REVERSE);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      ierr = LibMeshVecScatterDestroy(&amp;scatter);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          <span class="comment">/* Before we delete subprecond_matrix, we should give the</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">             _preconditioner a different matrix.  */</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;set_matrix(<span class="keyword">const_cast&lt;</span>SparseMatrix&lt;Number&gt;&amp;<span class="keyword">&gt;</span>(precond_matrix));</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">_preconditioner</a>-&gt;init();</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;          <span class="keyword">delete</span> subprecond_matrix;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          subprecond_matrix = NULL;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      ierr = LibMeshVecDestroy(&amp;subsolution);</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      ierr = LibMeshVecDestroy(&amp;subrhs);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      ierr = LibMeshMatDestroy(&amp;submat);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      ierr = LibMeshMatDestroy(&amp;subprecond);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">// Destroy the matrix.</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  ierr = LibMeshMatDestroy(&amp;mat);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  LIBMESH_CHKERR(ierr);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <a class="code" href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">STOP_LOG</a>(<span class="stringliteral">&quot;solve()&quot;</span>, <span class="stringliteral">&quot;PetscLinearSolver&quot;</span>);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">// return the # of its. and the final residual norm.</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">return</span> std::make_pair(its, final_resid);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a0181f398c4d6a8087b9c0b9764bac58b">libMesh::SUBSET_DONT_TOUCH</a></div><div class="ttdoc">Leaves dofs outside the subset unchanged. This is fastest, but also most confusing because it abandon...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00035">enum_subset_solve_mode.h:35</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ac03a5d846eeb24a13168f6b5358f86e3"><div class="ttname"><a href="namespacelibMesh.html#ac03a5d846eeb24a13168f6b5358f86e3">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(remote_elem)</div></div>
<div class="ttc" id="namespacelibMesh_html_aefa921f501605f00f5881b914fca3eeb"><div class="ttname"><a href="namespacelibMesh.html#aefa921f501605f00f5881b914fca3eeb">libMesh::STOP_LOG</a></div><div class="ttdeci">STOP_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
<div class="ttc" id="classlibMesh_1_1Parallel_1_1Communicator_html_a3eca1f7abf02a11e5812b08b1d65f80b"><div class="ttname"><a href="classlibMesh_1_1Parallel_1_1Communicator.html#a3eca1f7abf02a11e5812b08b1d65f80b">libMesh::Parallel::Communicator::size</a></div><div class="ttdeci">unsigned int size() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel_8h_source.html#l00699">parallel.h:699</a></div></div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a1764c79388b56d08361c785aa265add0"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a1764c79388b56d08361c785aa265add0">libMesh::LinearSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner&lt; T &gt; * _preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00279">linear_solver.h:279</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8fa06334f777e9c90c96d69a052985e5"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8fa06334f777e9c90c96d69a052985e5">libMesh::PetscLinearSolver::init</a></div><div class="ttdeci">virtual void init(const char *name=NULL) libmesh_override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l00163">petsc_linear_solver.C:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ae498bcd21156b9579c241812fe40c3c2"><div class="ttname"><a href="namespacelibMesh.html#ae498bcd21156b9579c241812fe40c3c2">libMesh::PetscErrorCode</a></div><div class="ttdeci">int PetscErrorCode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__diff__solver_8C_source.html#l00044">petsc_diff_solver.C:44</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a30be0945c067164d6d60997d8429b64e">libMesh::SUBSET_ZERO</a></div><div class="ttdoc">Set dofs outside the subset to zero. </div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00033">enum_subset_solve_mode.h:33</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a53c040d15138a248ff0f1006aa42a23c"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">libMesh::PetscLinearSolver::_create_complement_is</a></div><div class="ttdeci">void _create_complement_is(const NumericVector&lt; T &gt; &amp;vec_in)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00376">petsc_linear_solver.h:376</a></div></div>
<div class="ttc" id="petsc__linear__solver_8h_html_a515706180f960b30595b607f2d734d14"><div class="ttname"><a href="petsc__linear__solver_8h.html#a515706180f960b30595b607f2d734d14">PetscInt</a></div><div class="ttdeci">int PetscInt</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00062">petsc_linear_solver.h:62</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aca0fc5357cfc5608df9c2ed47ae2c471"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aca0fc5357cfc5608df9c2ed47ae2c471">libMesh::PetscLinearSolver::_petsc_shell_matrix_mult_add</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_mult_add(Mat mat, Vec arg, Vec add, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01985">petsc_linear_solver.C:1985</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a03d02ae8c0dab01091f6b27bd0765c7d"><div class="ttname"><a href="namespacelibMesh.html#a03d02ae8c0dab01091f6b27bd0765c7d">libMesh::ierr</a></div><div class="ttdeci">ierr</div><div class="ttdef"><b>Definition:</b> <a href="petsc__preconditioner_8C_source.html#l00281">petsc_preconditioner.C:281</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a9dce039d2a51416c1f7c6c3c281abe28"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a9dce039d2a51416c1f7c6c3c281abe28">libMesh::PetscLinearSolver::_restrict_solve_to_is</a></div><div class="ttdeci">IS _restrict_solve_to_is</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00302">petsc_linear_solver.h:302</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af"><div class="ttname"><a href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1a03a8f15eb2245113c17cc1b6e3ca14af">libMesh::SUBSET_COPY_RHS</a></div><div class="ttdoc">Set dofs outside the subset to the value of the corresponding dofs of the right hand side...</div><div class="ttdef"><b>Definition:</b> <a href="enum__subset__solve__mode_8h_source.html#l00034">enum_subset_solve_mode.h:34</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a74fc6258796b7724355d07fac71e335b"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a74fc6258796b7724355d07fac71e335b">libMesh::PetscLinearSolver::_petsc_shell_matrix_mult</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_mult(Mat mat, Vec arg, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l01961">petsc_linear_solver.C:1961</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_ac6c04c198cbb2b5ad74b6e0565ec5cfb"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#ac6c04c198cbb2b5ad74b6e0565ec5cfb">libMesh::PetscLinearSolver::_restrict_solve_to_is_complement</a></div><div class="ttdeci">IS _restrict_solve_to_is_complement</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00309">petsc_linear_solver.h:309</a></div></div>
<div class="ttc" id="classlibMesh_1_1ParallelObject_html_a20de1180df21bdc9e6ca6151ed4ffda9"><div class="ttname"><a href="classlibMesh_1_1ParallelObject.html#a20de1180df21bdc9e6ca6151ed4ffda9">libMesh::ParallelObject::comm</a></div><div class="ttdeci">const Parallel::Communicator &amp; comm() const </div><div class="ttdef"><b>Definition:</b> <a href="parallel__object_8h_source.html#l00087">parallel_object.h:87</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a005e7b0e81dbc5d604296fa441692d30"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a005e7b0e81dbc5d604296fa441692d30">libMesh::PetscLinearSolver::_restrict_solve_to_is_local_size</a></div><div class="ttdeci">PetscInt _restrict_solve_to_is_local_size(void) const </div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00361">petsc_linear_solver.h:361</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_aaf9b5a6769afcb1bb671446a30acd467"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#aaf9b5a6769afcb1bb671446a30acd467">libMesh::PetscLinearSolver::_subset_solve_mode</a></div><div class="ttdeci">SubsetSolveMode _subset_solve_mode</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00328">petsc_linear_solver.h:328</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8ab7a17b361ee3fc29048f828a3c2735"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8ab7a17b361ee3fc29048f828a3c2735">libMesh::PetscLinearSolver::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8h_source.html#l00296">petsc_linear_solver.h:296</a></div></div>
<div class="ttc" id="classlibMesh_1_1PetscLinearSolver_html_a8568708754d996fda7f23f507577b4e9"><div class="ttname"><a href="classlibMesh_1_1PetscLinearSolver.html#a8568708754d996fda7f23f507577b4e9">libMesh::PetscLinearSolver::_petsc_shell_matrix_get_diagonal</a></div><div class="ttdeci">static PetscErrorCode _petsc_shell_matrix_get_diagonal(Mat mat, Vec dest)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__linear__solver_8C_source.html#l02015">petsc_linear_solver.C:2015</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a7548a5faa85e5027223ef5c57d792445"><div class="ttname"><a href="namespacelibMesh.html#a7548a5faa85e5027223ef5c57d792445">libMesh::START_LOG</a></div><div class="ttdeci">START_LOG(&quot;std::sqrt()&quot;,&quot;ExactErrorEstimator&quot;)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc0164941ecaaf3e877fcb5fa89750f6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::solve </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1ShellMatrix.html">ShellMatrix</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; T &gt; *&#160;</td>
          <td class="paramname"><em>precond_matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n_iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves a system whose matrix is a shell matrix, but an optional sparse matrix may be used as preconditioning matrix. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00349">349</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (pc_mat)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">solve</a>(mat, *pc_mat, sol, rhs, tol, n_iter);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">solve</a>(mat, sol, rhs, tol, n_iter);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a9663fee6659bd9705e72142d5e42a02a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a9663fee6659bd9705e72142d5e42a02a">libMesh::LinearSolver::solve</a></div><div class="ttdeci">virtual std::pair&lt; unsigned int, Real &gt; solve(SparseMatrix&lt; T &gt; &amp;, NumericVector&lt; T &gt; &amp;, NumericVector&lt; T &gt; &amp;, const double, const unsigned int)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a56acf56ca513a30cea0a71c4391cda3a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a> <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::solver_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the type of solver to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00112">112</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">_solver_type</a>; }</div>
<div class="ttc" id="classlibMesh_1_1LinearSolver_html_a6b64a30f2023ff38c662536f79a4451a"><div class="ttname"><a href="classlibMesh_1_1LinearSolver.html#a6b64a30f2023ff38c662536f79a4451a">libMesh::LinearSolver::_solver_type</a></div><div class="ttdeci">SolverType _solver_type</div><div class="ttdef"><b>Definition:</b> <a href="linear__solver_8h_source.html#l00264">linear_solver.h:264</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a1ffb5b08919ab435109a302f94a7b3eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Parallel_1_1Communicator.html">Parallel::Communicator</a>&amp; libMesh::ParallelObject::_communicator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="parallel__object_8h_source.html#l00105">105</a> of file <a class="el" href="parallel__object_8h_source.html">parallel_object.h</a>.</p>

<p>Referenced by <a class="el" href="equation__systems_8C_source.html#l00673">libMesh::EquationSystems::build_solution_vector()</a>, <a class="el" href="parallel__object_8h_source.html#l00087">libMesh::ParallelObject::comm()</a>, <a class="el" href="equation__systems_8C_source.html#l00886">libMesh::EquationSystems::get_solution()</a>, <a class="el" href="parallel__object_8h_source.html#l00093">libMesh::ParallelObject::n_processors()</a>, <a class="el" href="parallel__object_8h_source.html#l00072">libMesh::ParallelObject::operator=()</a>, and <a class="el" href="parallel__object_8h_source.html#l00099">libMesh::ParallelObject::processor_id()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c913252d05560f8bc7c75a63547c4c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">ReferenceCounter::Counts</a> libMesh::ReferenceCounter::_counts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Actually holds the data. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00114">114</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>Referenced by <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>, <a class="el" href="reference__counter_8h_source.html#l00159">libMesh::ReferenceCounter::increment_constructor_count()</a>, and <a class="el" href="reference__counter_8h_source.html#l00172">libMesh::ReferenceCounter::increment_destructor_count()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f75e8a4a280f2c41636f2ae1307a311"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::ReferenceCounter::_enable_print_counter = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to control whether reference count information is printed when print_info is called. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00133">133</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>Referenced by <a class="el" href="reference__counter_8C_source.html#l00106">libMesh::ReferenceCounter::disable_print_counter_info()</a>, <a class="el" href="reference__counter_8C_source.html#l00100">libMesh::ReferenceCounter::enable_print_counter_info()</a>, and <a class="el" href="reference__counter_8C_source.html#l00088">libMesh::ReferenceCounter::print_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a97da17452484aa8121282f15248b8b9a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::_is_initialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag indicating if the data structures have been initialized. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00274">274</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

<p>Referenced by <a class="el" href="linear__solver_8h_source.html#l00086">libMesh::LinearSolver&lt; Number &gt;::initialized()</a>.</p>

</div>
</div>
<a class="anchor" id="a8ab7a17b361ee3fc29048f828a3c2735"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_ksp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Krylov subspace context </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00296">296</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>Referenced by <a class="el" href="petsc__linear__solver_8h_source.html#l00234">libMesh::PetscLinearSolver&lt; T &gt;::ksp()</a>.</p>

</div>
</div>
<a class="anchor" id="abedbd3a4ce19686187449a8a0557b74b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Threads_1_1spin__mutex.html">Threads::spin_mutex</a> libMesh::ReferenceCounter::_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Mutual exclusion object to enable thread-safe reference counting. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00127">127</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad2c30f0f71dcd00f00faa8e46aa3e043"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Threads_1_1atomic.html">Threads::atomic</a>&lt; unsigned int &gt; libMesh::ReferenceCounter::_n_objects</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The number of objects. Print the reference count information when the number returns to 0. </p>

<p>Definition at line <a class="el" href="reference__counter_8h_source.html#l00122">122</a> of file <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a>.</p>

<p>Referenced by <a class="el" href="reference__counter_8h_source.html#l00075">libMesh::ReferenceCounter::n_objects()</a>, <a class="el" href="reference__counter_8h_source.html#l00140">libMesh::ReferenceCounter::ReferenceCounter()</a>, and <a class="el" href="reference__counter_8h_source.html#l00147">libMesh::ReferenceCounter::~ReferenceCounter()</a>.</p>

</div>
</div>
<a class="anchor" id="aec0962b22c0c4b93c85a0eb73f356d08"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PC <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_pc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a> context </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00291">291</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

<p>Referenced by <a class="el" href="petsc__linear__solver_8h_source.html#l00227">libMesh::PetscLinearSolver&lt; T &gt;::pc()</a>.</p>

</div>
</div>
<a class="anchor" id="a1764c79388b56d08361c785aa265add0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a>&lt;T&gt;* <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Holds the <a class="el" href="classlibMesh_1_1Preconditioner.html">Preconditioner</a> object to be used for the linear solves. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00279">279</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a866f963e86c384dc28fb3dbec70c5b39"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ae32cb39661f0f330f8b2ce20725eff61">PreconditionerType</a> <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::_preconditioner_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enum statitng with type of preconditioner to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00269">269</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

<p>Referenced by <a class="el" href="trilinos__aztec__linear__solver_8h_source.html#l00168">libMesh::AztecLinearSolver&lt; T &gt;::AztecLinearSolver()</a>, and <a class="el" href="petsc__linear__solver_8h_source.html#l00335">libMesh::PetscLinearSolver&lt; T &gt;::PetscLinearSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a9dce039d2a51416c1f7c6c3c281abe28"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IS <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_restrict_solve_to_is</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PETSc index set containing the dofs on which to solve (<code>NULL</code> means solve on all dofs). </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00302">302</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac6c04c198cbb2b5ad74b6e0565ec5cfb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IS <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_restrict_solve_to_is_complement</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>PETSc index set, complement to <code>_restrict_solve_to_is</code>. This will be created on demand by the method <code><a class="el" href="classlibMesh_1_1PetscLinearSolver.html#a53c040d15138a248ff0f1006aa42a23c">_create_complement_is()</a></code>. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00309">309</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5e0e279c8b33fdebb77bb1866667c69e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SLES <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_sles</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Linear solver context </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00284">284</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa8d4f205b150f8ca380e3338af168237"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SolverConfiguration.html">SolverConfiguration</a>* <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::_solver_configuration</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Optionally store a SolverOptions object that can be used to set parameters like solver type, tolerances and iteration limits. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00293">293</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6b64a30f2023ff38c662536f79a4451a"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a67ae2194c38234da18c4833b879e3a54">SolverType</a> <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::_solver_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enum stating which type of iterative solver to use. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00264">264</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

<p>Referenced by <a class="el" href="eigen__sparse__linear__solver_8C_source.html#l00037">libMesh::EigenSparseLinearSolver&lt; T &gt;::EigenSparseLinearSolver()</a>, <a class="el" href="linear__solver_8h_source.html#l00117">libMesh::LinearSolver&lt; Number &gt;::set_solver_type()</a>, and <a class="el" href="linear__solver_8h_source.html#l00112">libMesh::LinearSolver&lt; Number &gt;::solver_type()</a>.</p>

</div>
</div>
<a class="anchor" id="aaf9b5a6769afcb1bb671446a30acd467"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a26778987aa56efc2654101b7deabd4a1">SubsetSolveMode</a> <a class="el" href="classlibMesh_1_1PetscLinearSolver.html">libMesh::PetscLinearSolver</a>&lt; T &gt;::_subset_solve_mode</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If restrict-solve-to-subset mode is active, this member decides what happens with the dofs outside the subset. </p>

<p>Definition at line <a class="el" href="petsc__linear__solver_8h_source.html#l00328">328</a> of file <a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a851fb44823b601cd8502fd7688266c29"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classlibMesh_1_1LinearSolver.html">libMesh::LinearSolver</a>&lt; T &gt;::same_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Boolean flag to indicate whether we want to use an identical preconditioner to the previous solve. This can save substantial work in the cases where the system matrix is the same for successive solves. </p>

<p>Definition at line <a class="el" href="linear__solver_8h_source.html#l00287">287</a> of file <a class="el" href="linear__solver_8h_source.html">linear_solver.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="petsc__linear__solver_8h_source.html">petsc_linear_solver.h</a></li>
<li><a class="el" href="petsc__linear__solver_8C_source.html">petsc_linear_solver.C</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
generated by <a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a>
</small></address>
<!-- dynamic header stuff -->
<script type="text/javascript">
$(document).ready(function(){
  $(window).on('scroll',function() {
    var scrolltop = $(this).scrollTop();
    if(scrolltop >= 215) {
      $('#fixedbar').fadeIn(250);
    }
    else if(scrolltop <= 210) {
      $('#fixedbar').fadeOut(250);
    }
  });
});
</script>
<!-- Google Analytics stuff -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24978333-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</body>
</html>
